<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AfagOS Full - Веб-операционная система</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* === ОСНОВНЫЕ СТИЛИ === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            background: linear-gradient(135deg, #0f172a, #1e293b);
            color: #f1f5f9;
            height: 100vh;
            overflow: hidden;
            touch-action: none;
        }

        /* === ЭКРАН ЗАГРУЗКИ === */
        #boot-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0f172a;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 0.8s ease-in-out;
        }
        
        .boot-logo {
            font-size: 4.5rem;
            font-weight: 900;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6, #ec4899);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 2rem;
            animation: logoPulse 2s infinite alternate;
            text-shadow: 0 0 40px rgba(59, 130, 246, 0.4);
            letter-spacing: 2px;
        }
        
        @keyframes logoPulse {
            0% { transform: scale(1); opacity: 0.9; }
            50% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(1); opacity: 0.9; }
        }
        
        .boot-subtitle {
            font-size: 1.3rem;
            color: #94a3b8;
            margin-bottom: 3rem;
            font-weight: 300;
            letter-spacing: 1px;
        }
        
        .boot-loader {
            width: 500px;
            max-width: 80%;
            height: 10px;
            background: rgba(30, 41, 59, 0.5);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 1.5rem;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(100, 116, 139, 0.2);
        }
        
        .boot-loader-bar {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6, #ec4899);
            width: 0%;
            transition: width 0.3s ease-out;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
        }
        
        .boot-loader-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.6), 
                transparent);
            animation: shimmer 1.5s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .boot-message {
            color: #cbd5e1;
            font-size: 1.1rem;
            height: 24px;
            margin-top: 1.5rem;
            text-align: center;
            font-weight: 500;
            min-height: 1.5em;
        }
        
        .boot-progress {
            font-size: 1rem;
            color: #8b5cf6;
            margin-top: 0.8rem;
            font-weight: 600;
            background: rgba(30, 41, 59, 0.5);
            padding: 0.5rem 1.5rem;
            border-radius: 20px;
            border: 1px solid rgba(139, 92, 246, 0.3);
        }

        /* === ЭКРАН ПЕРВОНАЧАЛЬНОЙ НАСТРОЙКИ === */
        #setup-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f172a, #1e293b);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9500;
            animation: fadeIn 0.5s;
            padding: 20px;
        }
        
        .setup-container {
            width: 100%;
            max-width: 700px;
            background: rgba(30, 41, 59, 0.95);
            border-radius: 24px;
            padding: 3rem;
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(100, 116, 139, 0.4);
            backdrop-filter: blur(30px);
            position: relative;
            overflow: hidden;
        }
        
        .setup-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6, #ec4899);
        }
        
        .setup-header {
            text-align: center;
            margin-bottom: 3rem;
            position: relative;
        }
        
        .setup-title {
            font-size: 2.8rem;
            font-weight: 800;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 1rem;
            letter-spacing: 1px;
        }
        
        .setup-subtitle {
            color: #94a3b8;
            font-size: 1.2rem;
            font-weight: 300;
            line-height: 1.6;
        }
        
        .setup-steps-container {
            margin-bottom: 2.5rem;
            min-height: 300px;
            position: relative;
        }
        
        .setup-step {
            animation: slideUp 0.4s ease-out;
            padding: 1rem;
        }
        
        .step-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #f1f5f9;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid rgba(59, 130, 246, 0.3);
        }
        
        .step-title i {
            color: #3b82f6;
            font-size: 1.6rem;
            width: 40px;
            height: 40px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .setup-input-group {
            margin-bottom: 1.8rem;
        }
        
        .setup-label {
            display: block;
            color: #cbd5e1;
            margin-bottom: 0.8rem;
            font-size: 1rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .setup-label i {
            color: #8b5cf6;
            font-size: 0.9rem;
        }
        
        .setup-input {
            width: 100%;
            padding: 1.2rem 1.5rem;
            background: rgba(15, 23, 42, 0.8);
            border: 2px solid #475569;
            border-radius: 12px;
            color: #f1f5f9;
            font-size: 1.1rem;
            outline: none;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .setup-input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.15);
            background: rgba(15, 23, 42, 0.9);
        }
        
        .setup-input::placeholder {
            color: #64748b;
        }
        
        .setup-select {
            width: 100%;
            padding: 1.2rem 1.5rem;
            background: rgba(15, 23, 42, 0.8);
            border: 2px solid #475569;
            border-radius: 12px;
            color: #f1f5f9;
            font-size: 1.1rem;
            outline: none;
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%233b82f6' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 1.5rem center;
            background-size: 1rem;
            padding-right: 3.5rem;
        }
        
        .setup-select:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.15);
        }
        
        .setup-checkbox-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin: 1.5rem 0;
        }
        
        .setup-checkbox {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid transparent;
        }
        
        .setup-checkbox:hover {
            background: rgba(59, 130, 246, 0.1);
            border-color: rgba(59, 130, 246, 0.3);
        }
        
        .setup-checkbox input[type="checkbox"] {
            width: 22px;
            height: 22px;
            cursor: pointer;
            accent-color: #3b82f6;
            flex-shrink: 0;
        }
        
        .setup-checkbox label {
            flex: 1;
            cursor: pointer;
            font-size: 1rem;
            color: #e2e8f0;
            font-weight: 500;
        }
        
        .setup-checkbox .app-price {
            font-weight: 700;
            color: #10b981;
            font-size: 1.1rem;
            margin-left: auto;
            padding-left: 1rem;
        }
        
        .setup-app-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            flex-shrink: 0;
        }
        
        .setup-finish-container {
            text-align: center;
            padding: 2rem;
        }
        
        .setup-finish-icon {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, #10b981, #3b82f6);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 2rem;
            color: white;
            font-size: 3.5rem;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4); }
            70% { transform: scale(1.05); box-shadow: 0 0 0 20px rgba(16, 185, 129, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); }
        }
        
        .setup-finish-title {
            font-size: 2rem;
            font-weight: 700;
            color: #f1f5f9;
            margin-bottom: 1rem;
        }
        
        .setup-finish-text {
            color: #cbd5e1;
            font-size: 1.1rem;
            line-height: 1.6;
            max-width: 500px;
            margin: 0 auto 2rem;
        }
        
        .setup-progress-container {
            margin: 2.5rem 0;
        }
        
        .setup-progress-text {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.8rem;
            font-size: 0.95rem;
            color: #94a3b8;
        }
        
        .setup-progress {
            width: 100%;
            height: 8px;
            background: #334155;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }
        
        .setup-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            width: 0%;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .setup-progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.4), 
                transparent);
            animation: shimmer 2s infinite;
        }
        
        .setup-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
            gap: 1rem;
        }
        
        .setup-button {
            padding: 1.2rem 3rem;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            min-width: 140px;
        }
        
        .setup-button.back {
            background: rgba(71, 85, 105, 0.7);
            color: #e2e8f0;
            border: 1px solid rgba(100, 116, 139, 0.3);
        }
        
        .setup-button.back:hover:not(:disabled) {
            background: rgba(71, 85, 105, 0.9);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }
        
        .setup-button.next {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
            border: none;
        }
        
        .setup-button.next:hover:not(:disabled) {
            background: linear-gradient(135deg, #2563eb, #7c3aed);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.4);
        }
        
        .setup-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }
        
        .setup-button i {
            font-size: 1.2rem;
        }

        /* === ЭКРАН БЛОКИРОВКИ === */
        #lock-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(rgba(15, 23, 42, 0.95), rgba(30, 41, 59, 0.98)), 
                        url('https://images.unsplash.com/photo-1519681393784-d120267933ba?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80');
            background-size: cover;
            background-position: center;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9000;
            animation: fadeIn 0.5s;
        }
        
        .lock-time {
            font-size: 6.5rem;
            font-weight: 300;
            margin-bottom: 0.5rem;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 4px 30px rgba(59, 130, 246, 0.3);
            font-feature-settings: "tnum";
            animation: timeGlow 4s infinite alternate;
        }
        
        @keyframes timeGlow {
            0% { text-shadow: 0 4px 20px rgba(59, 130, 246, 0.5); }
            100% { text-shadow: 0 4px 50px rgba(139, 92, 246, 0.8); }
        }
        
        .lock-date {
            font-size: 2rem;
            color: #cbd5e1;
            margin-bottom: 4rem;
            font-weight: 300;
            letter-spacing: 1px;
        }
        
        .lock-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 2.5rem;
            border: 4px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
            animation: avatarFloat 6s ease-in-out infinite;
        }
        
        @keyframes avatarFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }
        
        .lock-avatar i {
            font-size: 3.5rem;
            color: white;
        }
        
        .lock-prompt {
            background: rgba(15, 23, 42, 0.9);
            padding: 2.5rem 3rem;
            border-radius: 24px;
            display: flex;
            flex-direction: column;
            align-items: center;
            backdrop-filter: blur(30px);
            border: 1px solid rgba(100, 116, 139, 0.4);
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.6);
            animation: slideUp 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            min-width: 400px;
        }
        
        @keyframes slideUp {
            from { transform: translateY(60px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .lock-username {
            font-size: 1.8rem;
            color: #f1f5f9;
            margin-bottom: 1.8rem;
            font-weight: 600;
            text-align: center;
        }
        
        .lock-input-container {
            position: relative;
            width: 100%;
            margin-bottom: 1.5rem;
        }
        
        .lock-input {
            width: 100%;
            background: rgba(30, 41, 59, 0.9);
            border: 2px solid #475569;
            color: #f1f5f9;
            padding: 1.4rem 1.8rem 1.4rem 3.5rem;
            border-radius: 14px;
            font-size: 1.3rem;
            outline: none;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            letter-spacing: 2px;
        }
        
        .lock-input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.2);
            transform: translateY(-2px);
            background: rgba(30, 41, 59, 0.95);
        }
        
        .lock-input::placeholder {
            color: #64748b;
            letter-spacing: normal;
        }
        
        .lock-input-icon {
            position: absolute;
            left: 1.2rem;
            top: 50%;
            transform: translateY(-50%);
            color: #8b5cf6;
            font-size: 1.4rem;
        }
        
        .lock-button {
            width: 100%;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
            border: none;
            padding: 1.4rem;
            border-radius: 14px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            letter-spacing: 1px;
            text-transform: uppercase;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
        }
        
        .lock-button:hover {
            background: linear-gradient(135deg, #2563eb, #7c3aed);
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(59, 130, 246, 0.4);
        }
        
        .lock-button:active {
            transform: translateY(-1px);
        }
        
        .lock-error {
            color: #ef4444;
            margin-top: 1rem;
            font-size: 1rem;
            height: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-weight: 500;
        }
        
        .lock-hint {
            color: #94a3b8;
            font-size: 0.95rem;
            margin-top: 1.8rem;
            text-align: center;
            line-height: 1.5;
        }
        
        .lock-shortcuts {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .lock-shortcut {
            background: rgba(30, 41, 59, 0.7);
            border: 1px solid rgba(100, 116, 139, 0.3);
            color: #cbd5e1;
            padding: 0.8rem 1.5rem;
            border-radius: 10px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .lock-shortcut:hover {
            background: rgba(59, 130, 246, 0.2);
            border-color: rgba(59, 130, 246, 0.5);
            color: #f1f5f9;
        }

        /* === РАБОЧИЙ СТОЛ === */
        #desktop {
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            animation: fadeIn 0.5s;
            overflow: hidden;
        }
        
        /* Фон рабочего стола */
        #desktop-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f172a, #1e293b);
            z-index: -1;
        }
        
        /* Область с иконками */
        .desktop-area {
            flex: 1;
            padding: 2rem;
            position: relative;
            overflow: hidden;
        }
        
        .desktop-icons {
            display: grid;
            grid-template-columns: repeat(auto-fill, 120px);
            grid-auto-rows: 120px;
            gap: 2rem;
            position: relative;
            z-index: 1;
        }
        
        .desktop-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            width: 120px;
            height: 120px;
            background: rgba(15, 23, 42, 0.4);
            border: 1px solid rgba(100, 116, 139, 0.2);
            position: relative;
            overflow: hidden;
            user-select: none;
        }
        
        .desktop-icon.selected {
            background: rgba(59, 130, 246, 0.3);
            border-color: rgba(59, 130, 246, 0.6);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.2);
        }
        
        .desktop-icon::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(59, 130, 246, 0.1), 
                rgba(139, 92, 246, 0.1));
            opacity: 0;
            transition: opacity 0.3s;
            border-radius: inherit;
        }
        
        .desktop-icon:hover::before {
            opacity: 1;
        }
        
        .desktop-icon:hover {
            transform: translateY(-10px) scale(1.08);
            background: rgba(15, 23, 42, 0.6);
            border-color: rgba(59, 130, 246, 0.4);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
        }
        
        .desktop-icon:active {
            transform: translateY(-5px) scale(1.04);
        }
        
        .desktop-icon i {
            font-size: 2.8rem;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            transition: all 0.3s;
            z-index: 1;
        }
        
        .desktop-icon:hover i {
            transform: scale(1.2);
        }
        
        .desktop-icon-text {
            font-size: 0.95rem;
            text-align: center;
            color: #e2e8f0;
            font-weight: 600;
            z-index: 1;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            line-height: 1.3;
            word-break: break-word;
            max-width: 100%;
        }
        
        .desktop-context-menu {
            position: absolute;
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(100, 116, 139, 0.4);
            border-radius: 12px;
            padding: 0.8rem 0;
            min-width: 200px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
            display: none;
            z-index: 1000;
            animation: fadeIn 0.2s;
        }
        
        .context-item {
            padding: 0.8rem 1.5rem;
            color: #e2e8f0;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 0.95rem;
        }
        
        .context-item:hover {
            background: rgba(59, 130, 246, 0.2);
        }
        
        .context-item i {
            width: 20px;
            text-align: center;
            color: #8b5cf6;
        }
        
        .context-divider {
            height: 1px;
            background: rgba(100, 116, 139, 0.3);
            margin: 0.5rem 0;
        }

        /* === ПАНЕЛЬ ЗАДАЧ === */
        .taskbar {
            background: rgba(15, 23, 42, 0.95);
            height: 65px;
            display: flex;
            align-items: center;
            padding: 0 1.5rem;
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(100, 116, 139, 0.4);
            position: relative;
            z-index: 1000;
            box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.3);
            gap: 1.5rem;
        }
        
        .start-button {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 0.8rem 1.8rem;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 700;
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.3);
            min-width: 140px;
        }
        
        .start-button:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.4);
            background: linear-gradient(135deg, #2563eb, #7c3aed);
        }
        
        .start-button:active {
            transform: scale(1.02);
        }
        
        .start-button i {
            font-size: 1.4rem;
        }
        
        .taskbar-apps {
            display: flex;
            flex: 1;
            gap: 1rem;
            overflow-x: auto;
            padding: 0.5rem;
            scrollbar-width: none;
        }
        
        .taskbar-apps::-webkit-scrollbar {
            display: none;
        }
        
        .taskbar-app {
            background: rgba(30, 41, 59, 0.7);
            padding: 0.8rem 1.5rem;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: all 0.3s;
            white-space: nowrap;
            min-width: fit-content;
            border: 2px solid transparent;
            position: relative;
        }
        
        .taskbar-app:hover {
            background: rgba(59, 130, 246, 0.3);
            transform: translateY(-2px);
            border-color: rgba(59, 130, 246, 0.5);
        }
        
        .taskbar-app.active {
            background: rgba(59, 130, 246, 0.5);
            border-color: rgba(59, 130, 246, 0.8);
            box-shadow: 0 6px 15px rgba(59, 130, 246, 0.2);
        }
        
        .taskbar-app.progress::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            border-radius: 0 0 10px 10px;
            animation: progressBar 2s infinite linear;
        }
        
        @keyframes progressBar {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .taskbar-center {
            display: flex;
            gap: 1.2rem;
            margin: 0 2rem;
        }
        
        .taskbar-widget {
            background: rgba(30, 41, 59, 0.7);
            padding: 0.7rem 1.4rem;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }
        
        .taskbar-widget:hover {
            background: rgba(59, 130, 246, 0.3);
            transform: translateY(-2px);
        }
        
        .taskbar-widget.notification::after {
            content: '';
            position: absolute;
            top: 8px;
            right: 8px;
            width: 8px;
            height: 8px;
            background: #ef4444;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        .taskbar-right {
            display: flex;
            align-items: center;
            gap: 1.8rem;
            margin-left: auto;
        }
        
        .system-tray {
            display: flex;
            gap: 1.2rem;
        }
        
        .tray-icon {
            width: 45px;
            height: 45px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(30, 41, 59, 0.7);
            position: relative;
        }
        
        .tray-icon:hover {
            background: rgba(59, 130, 246, 0.3);
            transform: translateY(-2px);
        }
        
        .tray-icon.badge::after {
            content: '';
            position: absolute;
            top: 8px;
            right: 8px;
            width: 6px;
            height: 6px;
            background: #ef4444;
            border-radius: 50%;
        }
        
        .time-display {
            background: rgba(30, 41, 59, 0.7);
            padding: 0.9rem 1.8rem;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 180px;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .time-display:hover {
            background: rgba(59, 130, 246, 0.2);
            transform: translateY(-2px);
        }
        
        .time {
            font-size: 1.2rem;
            font-weight: 700;
            font-feature-settings: "tnum";
        }
        
        .date {
            font-size: 0.9rem;
            color: #94a3b8;
            margin-top: 0.3rem;
        }

        /* === УЛУЧШЕННОЕ МЕНЮ ПУСК === */
        #start-menu {
            position: absolute;
            bottom: 75px;
            left: 30px;
            width: 480px;
            height: 700px;
            background: rgba(15, 23, 42, 0.98);
            border-radius: 24px;
            backdrop-filter: blur(40px);
            border: 1px solid rgba(100, 116, 139, 0.5);
            display: none;
            z-index: 800;
            box-shadow: 0 35px 70px rgba(0, 0, 0, 0.6);
            animation: menuSlide 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            overflow: hidden;
            flex-direction: column;
        }
        
        @keyframes menuSlide {
            from { transform: translateY(60px) scale(0.95); opacity: 0; }
            to { transform: translateY(0) scale(1); opacity: 1; }
        }
        
        .start-header {
            padding: 2.5rem;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
            font-weight: 800;
            font-size: 2rem;
            display: flex;
            align-items: center;
            gap: 1.5rem;
            position: relative;
            overflow: hidden;
        }
        
        .start-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.1), 
                transparent 30%);
        }
        
        .start-user {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 1.5rem;
            z-index: 1;
        }
        
        .start-avatar {
            width: 60px;
            height: 60px;
            border-radius: 16px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .start-avatar i {
            font-size: 2rem;
            color: white;
        }
        
        .start-user-info {
            display: flex;
            flex-direction: column;
        }
        
        .start-username {
            font-size: 1.4rem;
            font-weight: 700;
        }
        
        .start-user-role {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-top: 0.3rem;
        }
        
        .start-search {
            flex: 1;
            padding: 0 2rem;
            display: flex;
            gap: 1rem;
        }
        
        .search-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            font-size: 1rem;
            outline: none;
            backdrop-filter: blur(10px);
        }
        
        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }
        
        .search-button {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.2s;
        }
        
        .search-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }
        
        .start-content {
            flex: 1;
            display: flex;
            overflow: hidden;
        }
        
        .start-sidebar {
            width: 200px;
            background: rgba(30, 41, 59, 0.7);
            padding: 1.5rem;
            border-right: 1px solid rgba(100, 116, 139, 0.3);
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .start-section {
            margin-bottom: 1.5rem;
        }
        
        .section-title {
            font-size: 0.9rem;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 1rem;
            font-weight: 600;
        }
        
        .start-item {
            padding: 0.8rem 1rem;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: all 0.2s;
            color: #e2e8f0;
            font-weight: 500;
        }
        
        .start-item:hover {
            background: rgba(59, 130, 246, 0.2);
        }
        
        .start-item.active {
            background: rgba(59, 130, 246, 0.3);
            color: #3b82f6;
            font-weight: 600;
        }
        
        .start-item i {
            width: 24px;
            text-align: center;
            font-size: 1.2rem;
        }
        
        .start-main {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }
        
        .pinned-apps {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.2rem;
        }
        
        .pinned-app {
            background: rgba(30, 41, 59, 0.5);
            border-radius: 14px;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid transparent;
            text-align: center;
            min-height: 120px;
        }
        
        .pinned-app:hover {
            background: rgba(59, 130, 246, 0.2);
            transform: translateY(-5px) scale(1.05);
            border-color: rgba(59, 130, 246, 0.5);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }
        
        .pinned-app i {
            font-size: 2.2rem;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .pinned-app-name {
            font-size: 0.95rem;
            font-weight: 600;
            color: #f1f5f9;
        }
        
        .recent-apps {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }
        
        .recent-app {
            padding: 1rem;
            background: rgba(30, 41, 59, 0.3);
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: all 0.2s;
        }
        
        .recent-app:hover {
            background: rgba(59, 130, 246, 0.1);
        }
        
        .recent-app-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }
        
        .recent-app-info {
            flex: 1;
        }
        
        .recent-app-name {
            font-weight: 500;
            color: #f1f5f9;
            font-size: 0.95rem;
        }
        
        .recent-app-time {
            font-size: 0.8rem;
            color: #94a3b8;
            margin-top: 0.2rem;
        }
        
        .start-footer {
            padding: 1.5rem 2.5rem;
            background: rgba(30, 41, 59, 0.7);
            border-top: 1px solid rgba(100, 116, 139, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .power-button {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .power-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(239, 68, 68, 0.3);
        }
        
        .user-status {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            color: #94a3b8;
            font-size: 0.9rem;
        }
        
        .status-indicator {
            width: 10px;
            height: 10px;
            background: #10b981;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        /* === ОКНА ПРИЛОЖЕНИЙ === */
        .app-window {
            position: fixed;
            top: 100px;
            left: 100px;
            width: 900px;
            height: 600px;
            background: #1e293b;
            border-radius: 20px;
            box-shadow: 0 30px 70px rgba(0, 0, 0, 0.6);
            display: none;
            flex-direction: column;
            z-index: 500;
            overflow: hidden;
            border: 1px solid #475569;
            animation: windowOpen 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            resize: both;
            min-width: 400px;
            min-height: 300px;
            max-width: calc(100vw - 100px);
            max-height: calc(100vh - 100px);
        }
        
        @keyframes windowOpen {
            from { 
                opacity: 0; 
                transform: scale(0.8) translateY(50px); 
            }
            to { 
                opacity: 1; 
                transform: scale(1) translateY(0); 
            }
        }
        
        .window-header {
            background: linear-gradient(135deg, #0f172a, #1e293b);
            padding: 1.2rem 1.8rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #475569;
            cursor: move;
            user-select: none;
            flex-shrink: 0;
            position: relative;
        }
        
        .window-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            border-radius: 20px 20px 0 0;
        }
        
        .window-title-container {
            display: flex;
            align-items: center;
            gap: 1.2rem;
            flex: 1;
            min-width: 0;
        }
        
        .window-icon {
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #3b82f6;
            font-size: 1.3rem;
            flex-shrink: 0;
        }
        
        .window-title {
            font-weight: 700;
            color: #f1f5f9;
            font-size: 1.2rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .window-controls {
            display: flex;
            gap: 0.8rem;
        }
        
        .window-control {
            background: #475569;
            color: #f1f5f9;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            font-size: 1.1rem;
        }
        
        .window-control:hover {
            background: #64748b;
            transform: scale(1.1);
        }
        
        .window-control.close:hover {
            background: #ef4444;
        }
        
        .window-content {
            flex: 1;
            padding: 1.8rem;
            overflow: auto;
            position: relative;
        }
        
        /* === ПРОДВИНУТЫЙ БРАУЗЕР === */
        .browser-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            gap: 1.5rem;
        }
        
        .browser-toolbar {
            display: flex;
            margin-bottom: 1rem;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
            background: #0f172a;
            padding: 1rem;
            border-radius: 14px;
        }
        
        .browser-controls {
            display: flex;
            gap: 0.8rem;
        }
        
        .browser-control {
            background: #475569;
            color: white;
            border: none;
            width: 46px;
            height: 46px;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            font-size: 1.2rem;
        }
        
        .browser-control:hover {
            background: #64748b;
            transform: scale(1.05);
        }
        
        .browser-control:active {
            transform: scale(0.95);
        }
        
        .browser-control.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .browser-url-bar {
            flex: 1;
            display: flex;
            min-width: 300px;
            background: rgba(15, 23, 42, 0.8);
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid #475569;
        }
        
        .url-input {
            flex: 1;
            background: transparent;
            border: none;
            color: #f1f5f9;
            padding: 1rem 1.5rem;
            font-size: 1.1rem;
            outline: none;
        }
        
        .url-input:focus {
            background: rgba(15, 23, 42, 0.9);
        }
        
        .url-actions {
            display: flex;
        }
        
        .url-action {
            background: rgba(71, 85, 105, 0.5);
            border: none;
            color: #cbd5e1;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1.1rem;
        }
        
        .url-action:hover {
            background: #475569;
            color: white;
        }
        
        .go-button {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
            border: none;
            padding: 0 2rem;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 600;
            font-size: 1.1rem;
            min-width: 100px;
        }
        
        .go-button:hover {
            background: linear-gradient(135deg, #2563eb, #7c3aed);
            transform: scale(1.02);
        }
        
        .browser-quick-access {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .quick-site {
            background: #0f172a;
            border-radius: 12px;
            padding: 1rem 1.5rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 1rem;
            border: 1px solid transparent;
        }
        
        .quick-site:hover {
            background: #1e293b;
            transform: translateY(-2px);
            border-color: #3b82f6;
        }
        
        .quick-site i {
            font-size: 1.5rem;
        }
        
        .quick-site.google { color: #4285f4; }
        .quick-site.youtube { color: #ff0000; }
        .quick-site.twitch { color: #9146ff; }
        .quick-site.github { color: #333; }
        
        .browser-tabs {
            display: flex;
            background: #0f172a;
            border-bottom: 1px solid #475569;
            overflow-x: auto;
            flex-shrink: 0;
            padding: 0.5rem;
            gap: 0.5rem;
        }
        
        .browser-tab {
            background: #1e293b;
            border-radius: 10px 10px 0 0;
            padding: 1rem 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 1rem;
            white-space: nowrap;
            min-width: 180px;
            transition: all 0.2s;
            position: relative;
            border: 1px solid #475569;
            border-bottom: none;
        }
        
        .browser-tab:hover {
            background: #2d3748;
        }
        
        .browser-tab.active {
            background: #0f172a;
            border-color: #3b82f6;
            border-bottom-color: #0f172a;
            margin-bottom: -1px;
        }
        
        .browser-tab-close {
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: #475569;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            margin-left: auto;
            transition: all 0.2s;
        }
        
        .browser-tab-close:hover {
            background: #ef4444;
            transform: scale(1.1);
        }
        
        .browser-content {
            flex: 1;
            background: white;
            border-radius: 14px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
        }
        
        .browser-frame {
            flex: 1;
            border: none;
            width: 100%;
            height: 100%;
        }
        
        .browser-loading {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: white;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }
        
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 2rem;
        }
        
        .loading-text {
            color: #475569;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .browser-status {
            padding: 1rem;
            background: #0f172a;
            color: #94a3b8;
            font-size: 0.95rem;
            border-top: 1px solid #475569;
            flex-shrink: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* === ТЕКСТОВЫЙ РЕДАКТОР === */
        .editor-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            gap: 1.5rem;
        }
        
        .editor-toolbar {
            display: flex;
            gap: 0.8rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            padding: 1.2rem;
            background: #0f172a;
            border-radius: 14px;
        }
        
        .editor-group {
            display: flex;
            gap: 0.5rem;
            padding-right: 1rem;
            border-right: 1px solid #475569;
        }
        
        .editor-group:last-child {
            border-right: none;
        }
        
        .editor-button {
            background: #475569;
            color: white;
            border: none;
            padding: 0.9rem 1.4rem;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            transition: all 0.2s;
            font-size: 1rem;
            font-weight: 500;
        }
        
        .editor-button:hover {
            background: #64748b;
            transform: translateY(-2px);
        }
        
        .editor-button.active {
            background: #3b82f6;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }
        
        .editor-area-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #0f172a;
            border-radius: 14px;
            overflow: hidden;
            border: 2px solid #475569;
        }
        
        .editor-tabs {
            display: flex;
            background: #1e293b;
            border-bottom: 1px solid #475569;
            padding: 0.5rem;
            gap: 0.5rem;
        }
        
        .editor-tab {
            padding: 0.8rem 1.5rem;
            background: #0f172a;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            border: 1px solid #475569;
            border-bottom: none;
        }
        
        .editor-tab.active {
            background: #0f172a;
            border-color: #3b82f6;
            margin-bottom: -1px;
        }
        
        .editor-area {
            flex: 1;
            background: #0f172a;
            color: #f1f5f9;
            font-family: 'Cascadia Code', 'Consolas', 'Monaco', monospace;
            font-size: 1.1rem;
            line-height: 1.6;
            outline: none;
            padding: 1.5rem;
            resize: none;
            border: none;
            white-space: pre-wrap;
            tab-size: 4;
        }
        
        .editor-area:focus {
            outline: none;
        }
        
        .editor-status {
            padding: 1rem;
            background: #1e293b;
            color: #94a3b8;
            font-size: 0.9rem;
            border-top: 1px solid #475569;
            display: flex;
            justify-content: space-between;
        }

        /* === МЕДИАПЛЕЕР === */
        .player-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            gap: 1.5rem;
        }
        
        .player-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #0f172a;
            padding: 1.5rem;
            border-radius: 14px;
        }
        
        .player-info {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }
        
        .player-cover {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
        }
        
        .player-details {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .player-title {
            font-size: 2rem;
            font-weight: 700;
            color: #f1f5f9;
        }
        
        .player-artist {
            font-size: 1.2rem;
            color: #94a3b8;
        }
        
        .player-video {
            flex: 1;
            background: #0f172a;
            border-radius: 14px;
            overflow: hidden;
            position: relative;
        }
        
        .player-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #1e293b, #0f172a);
            padding: 2rem;
        }
        
        .player-placeholder i {
            font-size: 5rem;
            color: #3b82f6;
            margin-bottom: 2rem;
        }
        
        .player-playlist {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .playlist-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(30, 41, 59, 0.5);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .playlist-item:hover {
            background: rgba(59, 130, 246, 0.2);
        }
        
        .playlist-item.active {
            background: rgba(59, 130, 246, 0.3);
            border-left: 4px solid #3b82f6;
        }
        
        .player-controls {
            display: flex;
            align-items: center;
            gap: 2rem;
            padding: 1.5rem;
            background: #0f172a;
            border-radius: 14px;
        }
        
        .player-button {
            background: #475569;
            color: white;
            border: none;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            font-size: 1.5rem;
        }
        
        .player-button:hover {
            background: #64748b;
            transform: scale(1.1);
        }
        
        .player-button.play {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            width: 70px;
            height: 70px;
            font-size: 1.8rem;
        }
        
        .player-progress {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .progress-bar {
            height: 6px;
            background: #475569;
            border-radius: 3px;
            overflow: hidden;
            cursor: pointer;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            width: 0%;
            transition: width 0.1s;
        }
        
        .progress-time {
            display: flex;
            justify-content: space-between;
            color: #94a3b8;
            font-size: 0.9rem;
        }
        
        .player-volume {
            display: flex;
            align-items: center;
            gap: 1rem;
            width: 200px;
        }

        /* === ФАЙЛОВЫЙ МЕНЕДЖЕР === */
        .file-manager {
            display: flex;
            height: 100%;
            gap: 1.5rem;
        }
        
        .file-sidebar {
            width: 250px;
            background: #0f172a;
            border-radius: 14px;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        
        .file-quick-access {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }
        
        .file-access-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.8rem 1rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            color: #e2e8f0;
        }
        
        .file-access-item:hover {
            background: rgba(59, 130, 246, 0.2);
        }
        
        .file-access-item.active {
            background: rgba(59, 130, 246, 0.3);
            color: #3b82f6;
            font-weight: 600;
        }
        
        .file-storage {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .storage-item {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .storage-label {
            display: flex;
            justify-content: space-between;
            color: #94a3b8;
            font-size: 0.9rem;
        }
        
        .storage-bar {
            height: 6px;
            background: #334155;
            border-radius: 3px;
            overflow: hidden;
        }
        
        .storage-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            border-radius: 3px;
        }
        
        .file-content {
            flex: 1;
            background: #0f172a;
            border-radius: 14px;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
        }
        
        .file-toolbar {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #334155;
        }
        
        .file-button {
            background: #475569;
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            transition: all 0.2s;
        }
        
        .file-button:hover {
            background: #64748b;
        }
        
        .file-path {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem;
            background: #1e293b;
            border-radius: 10px;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        
        .path-item {
            color: #cbd5e1;
            cursor: pointer;
            padding: 0.3rem 0.8rem;
            border-radius: 6px;
            transition: all 0.2s;
        }
        
        .path-item:hover {
            background: #334155;
        }
        
        .path-separator {
            color: #64748b;
        }
        
        .file-grid {
            flex: 1;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 1.5rem;
            overflow-y: auto;
            padding: 1rem;
        }
        
        .file-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1.5rem 1rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            background: rgba(30, 41, 59, 0.5);
            border: 1px solid transparent;
            min-height: 120px;
        }
        
        .file-item:hover {
            background: rgba(59, 130, 246, 0.2);
            border-color: rgba(59, 130, 246, 0.5);
            transform: translateY(-5px);
        }
        
        .file-item.selected {
            background: rgba(59, 130, 246, 0.3);
            border-color: #3b82f6;
        }
        
        .file-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: #3b82f6;
        }
        
        .file-name {
            font-size: 0.9rem;
            text-align: center;
            color: #e2e8f0;
            word-break: break-word;
            max-width: 100%;
        }
        
        .file-size {
            font-size: 0.8rem;
            color: #94a3b8;
            margin-top: 0.3rem;
        }

        /* === МАГАЗИН ПРИЛОЖЕНИЙ === */
        .app-store-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            gap: 1.5rem;
        }
        
        .app-store-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #0f172a;
            padding: 1.5rem;
            border-radius: 14px;
        }
        
        .app-store-search {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
            max-width: 500px;
        }
        
        .store-search-input {
            flex: 1;
            background: #1e293b;
            border: 2px solid #475569;
            color: #f1f5f9;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            font-size: 1.1rem;
            outline: none;
        }
        
        .store-search-input:focus {
            border-color: #3b82f6;
        }
        
        .store-categories {
            display: flex;
            gap: 1rem;
            overflow-x: auto;
            padding: 1rem;
            background: #0f172a;
            border-radius: 14px;
        }
        
        .store-category {
            background: #1e293b;
            color: #cbd5e1;
            border: 2px solid transparent;
            padding: 0.8rem 1.8rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
            font-weight: 500;
        }
        
        .store-category:hover {
            background: #2d3748;
            transform: translateY(-2px);
        }
        
        .store-category.active {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
            border-color: #3b82f6;
        }
        
        .app-grid {
            flex: 1;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.8rem;
            overflow-y: auto;
            padding: 1rem;
        }
        
        .app-card {
            background: #0f172a;
            border-radius: 18px;
            overflow: hidden;
            border: 1px solid #334155;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            display: flex;
            flex-direction: column;
        }
        
        .app-card:hover {
            transform: translateY(-12px) scale(1.02);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
            border-color: rgba(59, 130, 246, 0.5);
        }
        
        .app-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: linear-gradient(135deg, #10b981, #3b82f6);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            z-index: 2;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .app-icon {
            height: 160px;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            color: white;
            position: relative;
            overflow: hidden;
        }
        
        .app-icon::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.1), 
                transparent);
        }
        
        .app-info {
            padding: 1.8rem;
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .app-name {
            font-weight: 800;
            margin-bottom: 0.8rem;
            color: #f1f5f9;
            font-size: 1.3rem;
            line-height: 1.3;
        }
        
        .app-desc {
            font-size: 1rem;
            color: #94a3b8;
            margin-bottom: 1.5rem;
            line-height: 1.5;
            flex: 1;
        }
        
        .app-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
            color: #64748b;
        }
        
        .app-rating {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .stars {
            color: #fbbf24;
        }
        
        .app-size {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .app-price-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: auto;
        }
        
        .price-tag {
            font-weight: 800;
            color: #10b981;
            font-size: 1.5rem;
        }
        
        .price-tag.free {
            color: #3b82f6;
        }
        
        .install-button {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 700;
            transition: all 0.3s;
            min-width: 140px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
        }
        
        .install-button:hover:not(:disabled) {
            background: linear-gradient(135deg, #2563eb, #7c3aed);
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.4);
        }
        
        .install-button:active:not(:disabled) {
            transform: translateY(-1px);
        }
        
        .install-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: #475569;
        }
        
        .install-button.installed {
            background: #10b981;
        }
        
        .install-button.installed:hover {
            background: #059669;
        }

        /* === НАСТРОЙКИ СИСТЕМЫ === */
        .settings-container {
            display: flex;
            height: 100%;
            gap: 2rem;
        }
        
        .settings-sidebar {
            width: 280px;
            background: #0f172a;
            border-radius: 16px;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .settings-category {
            margin-bottom: 2rem;
        }
        
        .category-title {
            font-size: 1rem;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 1rem;
            font-weight: 700;
            padding-left: 1rem;
        }
        
        .settings-list {
            list-style: none;
        }
        
        .settings-item {
            padding: 1rem 1.5rem;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 1.2rem;
            transition: all 0.2s;
            color: #e2e8f0;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }
        
        .settings-item:hover {
            background: rgba(59, 130, 246, 0.1);
        }
        
        .settings-item.active {
            background: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
            font-weight: 600;
        }
        
        .settings-item i {
            width: 24px;
            text-align: center;
            font-size: 1.3rem;
        }
        
        .settings-content {
            flex: 1;
            background: #0f172a;
            border-radius: 16px;
            padding: 2rem;
            overflow-y: auto;
        }
        
        .settings-section {
            animation: fadeIn 0.3s;
        }
        
        .section-header {
            margin-bottom: 2.5rem;
        }
        
        .section-title {
            font-size: 2rem;
            font-weight: 800;
            color: #f1f5f9;
            margin-bottom: 0.5rem;
        }
        
        .section-description {
            color: #94a3b8;
            font-size: 1.1rem;
            line-height: 1.5;
        }
        
        .settings-group {
            margin-bottom: 2.5rem;
        }
        
        .group-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #f1f5f9;
            margin-bottom: 1.5rem;
            padding-bottom: 0.8rem;
            border-bottom: 2px solid rgba(59, 130, 246, 0.3);
        }
        
        .settings-option {
            background: #1e293b;
            border-radius: 14px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .option-info {
            flex: 1;
        }
        
        .option-title {
            font-weight: 600;
            color: #f1f5f9;
            margin-bottom: 0.5rem;
        }
        
        .option-description {
            color: #94a3b8;
            font-size: 0.95rem;
            line-height: 1.5;
        }
        
        .option-control {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .toggle-switch {
            position: relative;
            width: 60px;
            height: 30px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #475569;
            transition: .4s;
            border-radius: 34px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: #3b82f6;
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(30px);
        }
        
        .color-picker {
            display: flex;
            gap: 0.8rem;
        }
        
        .color-option {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        
        .color-option:hover {
            transform: scale(1.1);
        }
        
        .color-option.active {
            border-color: white;
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .color-option.dark { background: #0f172a; }
        .color-option.light { background: #f8fafc; }
        .color-option.blue { background: #1e40af; }
        .color-option.purple { background: #5b21b6; }

        /* === КАЛЬКУЛЯТОР === */
        .calculator {
            display: flex;
            flex-direction: column;
            height: 100%;
            gap: 2rem;
        }
        
        .calculator-display {
            background: #0f172a;
            border-radius: 16px;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            justify-content: flex-end;
            min-height: 120px;
        }
        
        .calc-history {
            font-size: 1.2rem;
            color: #94a3b8;
            min-height: 1.5em;
            text-align: right;
            width: 100%;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }
        
        .calc-current {
            font-size: 3rem;
            font-weight: 700;
            color: #f1f5f9;
            text-align: right;
            width: 100%;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }
        
        .calculator-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            flex: 1;
        }
        
        .calc-button {
            background: #475569;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.3rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
            user-select: none;
        }
        
        .calc-button:hover {
            background: #64748b;
            transform: translateY(-2px);
        }
        
        .calc-button:active {
            transform: translateY(0);
        }
        
        .calc-button.operator {
            background: #3b82f6;
        }
        
        .calc-button.operator:hover {
            background: #2563eb;
        }
        
        .calc-button.equals {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            grid-column: span 2;
        }
        
        .calc-button.equals:hover {
            background: linear-gradient(135deg, #2563eb, #7c3aed);
        }
        
        .calc-button.clear {
            background: #ef4444;
        }
        
        .calc-button.clear:hover {
            background: #dc2626;
        }
        
        .calc-button.zero {
            grid-column: span 2;
        }

        /* === ГРАФИЧЕСКИЙ РЕДАКТОР === */
        .paint-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            gap: 1.5rem;
        }
        
        .paint-toolbar {
            display: flex;
            align-items: center;
            gap: 2rem;
            padding: 1.5rem;
            background: #0f172a;
            border-radius: 14px;
            flex-wrap: wrap;
        }
        
        .paint-tools {
            display: flex;
            gap: 1rem;
        }
        
        .paint-tool {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            background: #475569;
            border: 2px solid transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .paint-tool:hover {
            background: #64748b;
            transform: scale(1.1);
        }
        
        .paint-tool.active {
            background: #3b82f6;
            border-color: white;
        }
        
        .color-palette {
            display: flex;
            gap: 0.8rem;
        }
        
        .paint-color {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s;
        }
        
        .paint-color:hover {
            transform: scale(1.1);
        }
        
        .paint-color.active {
            border-color: white;
            transform: scale(1.1);
        }
        
        .brush-size {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .size-slider {
            width: 150px;
        }
        
        .paint-canvas-container {
            flex: 1;
            background: #0f172a;
            border-radius: 14px;
            padding: 2rem;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .paint-canvas {
            background: white;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            cursor: crosshair;
            touch-action: none;
        }

        /* === КАЛЕНДАРЬ === */
        .calendar-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            gap: 1.5rem;
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #0f172a;
            padding: 1.5rem;
            border-radius: 14px;
        }
        
        .calendar-nav {
            display: flex;
            align-items: center;
            gap: 2rem;
        }
        
        .calendar-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #f1f5f9;
            min-width: 200px;
            text-align: center;
        }
        
        .nav-button {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            background: #475569;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .nav-button:hover {
            background: #64748b;
            transform: scale(1.1);
        }
        
        .calendar-grid {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #0f172a;
            border-radius: 14px;
            overflow: hidden;
        }
        
        .calendar-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            background: #1e293b;
            padding: 1.5rem 0;
        }
        
        .weekday {
            text-align: center;
            font-weight: 700;
            color: #f1f5f9;
            font-size: 1.1rem;
        }
        
        .calendar-days {
            flex: 1;
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            grid-auto-rows: 1fr;
            gap: 1px;
            background: #334155;
            padding: 1px;
        }
        
        .calendar-day {
            background: #0f172a;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .calendar-day:hover {
            background: #1e293b;
        }
        
        .day-number {
            font-size: 1.2rem;
            font-weight: 600;
            color: #f1f5f9;
        }
        
        .day-events {
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
        }
        
        .day-event {
            background: #3b82f6;
            color: white;
            padding: 0.3rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }
        
        .calendar-day.other-month {
            background: rgba(15, 23, 42, 0.5);
        }
        
        .calendar-day.other-month .day-number {
            color: #64748b;
        }
        
        .calendar-day.today {
            background: rgba(59, 130, 246, 0.2);
        }
        
        .calendar-day.today .day-number {
            color: #3b82f6;
            font-weight: 800;
        }
        
        .calendar-events {
            background: #0f172a;
            border-radius: 14px;
            padding: 1.5rem;
            max-height: 200px;
            overflow-y: auto;
        }

        /* === ЗАМЕТКИ === */
        .notes-container {
            display: flex;
            height: 100%;
            gap: 2rem;
        }
        
        .notes-sidebar {
            width: 300px;
            background: #0f172a;
            border-radius: 16px;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        
        .notes-list {
            flex: 1;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .note-item {
            background: #1e293b;
            border-radius: 12px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }
        
        .note-item:hover {
            background: #2d3748;
            transform: translateX(5px);
        }
        
        .note-item.active {
            background: rgba(59, 130, 246, 0.2);
            border-color: #3b82f6;
        }
        
        .note-title {
            font-weight: 700;
            color: #f1f5f9;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }
        
        .note-preview {
            color: #94a3b8;
            font-size: 0.9rem;
            line-height: 1.4;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }
        
        .note-date {
            font-size: 0.8rem;
            color: #64748b;
            margin-top: 0.8rem;
        }
        
        .notes-editor {
            flex: 1;
            background: #0f172a;
            border-radius: 16px;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        
        .editor-header {
            display: flex;
            gap: 1rem;
            align-items: center;
        }
        
        .note-title-input {
            flex: 1;
            background: transparent;
            border: none;
            color: #f1f5f9;
            font-size: 2rem;
            font-weight: 700;
            outline: none;
        }
        
        .note-title-input::placeholder {
            color: #64748b;
        }
        
        .note-editor {
            flex: 1;
            background: #1e293b;
            border-radius: 12px;
            padding: 1.5rem;
            color: #f1f5f9;
            font-size: 1.1rem;
            line-height: 1.6;
            outline: none;
            border: none;
            resize: none;
            font-family: inherit;
        }
        
        .note-editor:focus {
            outline: 2px solid #3b82f6;
        }
        
        .editor-tools {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* === ЦЕНТР УВЕДОМЛЕНИЙ === */
        .notification-center {
            position: fixed;
            top: 80px;
            right: 20px;
            width: 400px;
            max-height: 600px;
            background: rgba(15, 23, 42, 0.98);
            border-radius: 20px;
            backdrop-filter: blur(30px);
            border: 1px solid rgba(100, 116, 139, 0.5);
            display: none;
            flex-direction: column;
            z-index: 2000;
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.5);
            overflow: hidden;
        }
        
        .notification-header {
            padding: 1.8rem;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
            font-weight: 800;
            font-size: 1.3rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .notification-count {
            background: rgba(255, 255, 255, 0.2);
            padding: 0.3rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
        }
        
        .notification-clear {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.2s;
        }
        
        .notification-clear:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }
        
        .notification-list {
            flex: 1;
            overflow-y: auto;
            padding: 1.5rem;
        }
        
        .notification-item {
            background: rgba(30, 41, 59, 0.7);
            border-radius: 14px;
            padding: 1.5rem;
            margin-bottom: 1.2rem;
            border-left: 5px solid #3b82f6;
            animation: slideInRight 0.3s ease-out;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .notification-item:hover {
            background: rgba(59, 130, 246, 0.2);
            transform: translateX(-5px);
        }
        
        .notification-item.unread {
            border-left-color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
        }
        
        .notification-item.success {
            border-left-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }
        
        .notification-title {
            font-weight: 700;
            margin-bottom: 0.8rem;
            color: #f1f5f9;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .notification-time {
            font-size: 0.8rem;
            color: #94a3b8;
        }
        
        .notification-message {
            font-size: 1rem;
            color: #cbd5e1;
            line-height: 1.5;
        }
        
        .notification-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .notification-action {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        
        .notification-action.dismiss {
            background: #475569;
            color: white;
        }
        
        .notification-action.action {
            background: #3b82f6;
            color: white;
        }

        /* === СИСТЕМНЫЙ МОНИТОР === */
        .monitor-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            gap: 1.5rem;
        }
        
        .monitor-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
        }
        
        .stat-card {
            background: #0f172a;
            border-radius: 14px;
            padding: 1.8rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .stat-title {
            font-weight: 600;
            color: #94a3b8;
            font-size: 1rem;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 800;
            color: #f1f5f9;
        }
        
        .stat-progress {
            height: 6px;
            background: #334155;
            border-radius: 3px;
            overflow: hidden;
        }
        
        .stat-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            border-radius: 3px;
        }
        
        .monitor-charts {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            flex: 1;
        }
        
        .chart-container {
            background: #0f172a;
            border-radius: 14px;
            padding: 1.8rem;
            display: flex;
            flex-direction: column;
        }
        
        .chart-title {
            font-weight: 700;
            color: #f1f5f9;
            margin-bottom: 1.5rem;
            font-size: 1.2rem;
        }
        
        .chart {
            flex: 1;
            position: relative;
        }
        
        .chart-line {
            width: 100%;
            height: 200px;
            position: relative;
        }

        /* === МОДАЛЬНЫЕ ОКНА === */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            animation: fadeIn 0.3s;
            backdrop-filter: blur(20px);
            padding: 20px;
        }
        
        .modal-content {
            background: #1e293b;
            padding: 3rem;
            border-radius: 24px;
            width: 600px;
            max-width: 90vw;
            border: 1px solid #475569;
            box-shadow: 0 40px 80px rgba(0, 0, 0, 0.7);
            animation: modalAppear 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        @keyframes modalAppear {
            from { transform: scale(0.8) translateY(50px); opacity: 0; }
            to { transform: scale(1) translateY(0); opacity: 1; }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid rgba(59, 130, 246, 0.3);
        }
        
        .modal-title {
            font-size: 2.2rem;
            font-weight: 800;
            color: #f1f5f9;
        }
        
        .modal-close {
            background: #475569;
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            transition: all 0.2s;
        }
        
        .modal-close:hover {
            background: #ef4444;
            transform: scale(1.1);
        }
        
        .modal-text {
            margin-bottom: 2.5rem;
            color: #cbd5e1;
            line-height: 1.6;
            font-size: 1.2rem;
        }
        
        .modal-input {
            width: 100%;
            background: #0f172a;
            border: 2px solid #475569;
            color: #f1f5f9;
            padding: 1.2rem 1.5rem;
            border-radius: 12px;
            font-size: 1.1rem;
            margin-bottom: 2rem;
            outline: none;
        }
        
        .modal-input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.2);
        }
        
        .modal-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 1.5rem;
            margin-top: 3rem;
        }
        
        .modal-button {
            padding: 1.2rem 3rem;
            border-radius: 14px;
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 700;
            transition: all 0.3s;
            min-width: 140px;
        }
        
        .modal-button.cancel {
            background: #475569;
            color: white;
        }
        
        .modal-button.cancel:hover {
            background: #64748b;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }
        
        .modal-button.confirm {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
        }
        
        .modal-button.confirm:hover {
            background: linear-gradient(135deg, #2563eb, #7c3aed);
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.4);
        }
        
        .modal-button.delete {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }
        
        .modal-button.delete:hover {
            background: linear-gradient(135deg, #dc2626, #b91c1c);
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(239, 68, 68, 0.4);
        }

        /* === ВЫПАДАЮЩИЕ МЕНЮ === */
        .dropdown {
            position: absolute;
            background: rgba(30, 41, 59, 0.98);
            backdrop-filter: blur(30px);
            border: 1px solid rgba(100, 116, 139, 0.5);
            border-radius: 14px;
            padding: 1rem;
            min-width: 250px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 2000;
            animation: fadeIn 0.2s;
        }
        
        .dropdown-item {
            padding: 1rem 1.5rem;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 1.2rem;
            transition: all 0.2s;
            color: #e2e8f0;
        }
        
        .dropdown-item:hover {
            background: rgba(59, 130, 246, 0.2);
        }
        
        .dropdown-item.danger {
            color: #ef4444;
        }
        
        .dropdown-item.danger:hover {
            background: rgba(239, 68, 68, 0.1);
        }
        
        .dropdown-divider {
            height: 1px;
            background: rgba(100, 116, 139, 0.3);
            margin: 0.5rem 0;
        }

        /* === АНИМАЦИИ === */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        .shake {
            animation: shake 0.5s;
        }

        /* === СКРОЛЛБАР === */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(30, 41, 59, 0.5);
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #475569;
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }
        
        ::-webkit-scrollbar-corner {
            background: transparent;
        }

        /* === КОНТЕКСТНОЕ МЕНЮ === */
        .context-menu {
            position: fixed;
            background: rgba(30, 41, 59, 0.98);
            backdrop-filter: blur(30px);
            border: 1px solid rgba(100, 116, 139, 0.5);
            border-radius: 14px;
            padding: 0.8rem;
            min-width: 200px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 3000;
            animation: fadeIn 0.15s;
        }
        
        .context-menu-item {
            padding: 0.8rem 1.2rem;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: all 0.2s;
            color: #e2e8f0;
            font-size: 0.95rem;
        }
        
        .context-menu-item:hover {
            background: rgba(59, 130, 246, 0.2);
        }
        
        .context-menu-divider {
            height: 1px;
            background: rgba(100, 116, 139, 0.3);
            margin: 0.5rem 0;
        }

        /* === ТУЛТИПЫ === */
        .tooltip {
            position: absolute;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(100, 116, 139, 0.3);
            color: #f1f5f9;
            padding: 0.8rem 1.2rem;
            border-radius: 10px;
            font-size: 0.9rem;
            white-space: nowrap;
            z-index: 5000;
            pointer-events: none;
            animation: fadeIn 0.2s;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .tooltip::before {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: 5px solid rgba(15, 23, 42, 0.95);
        }

        /* === ОТВЕТСТВЕННОСТЬ === */
        @media (max-width: 1400px) {
            .app-window {
                min-width: 350px;
                min-height: 250px;
            }
            
            .start-menu {
                width: 420px;
                height: 650px;
            }
            
            .monitor-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .monitor-charts {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 1024px) {
            .desktop-icons {
                grid-template-columns: repeat(auto-fill, 100px);
                grid-auto-rows: 100px;
                gap: 1.5rem;
            }
            
            .desktop-icon {
                width: 100px;
                height: 100px;
                padding: 1rem;
            }
            
            .desktop-icon i {
                font-size: 2rem;
            }
            
            .taskbar {
                padding: 0 1rem;
                gap: 1rem;
            }
            
            .start-button {
                padding: 0.7rem 1.2rem;
                font-size: 1rem;
                min-width: 120px;
            }
            
            .time-display {
                min-width: 150px;
            }
        }
        
        @media (max-width: 768px) {
            .app-window {
                top: 50px !important;
                left: 20px !important;
                right: 20px !important;
                bottom: 80px !important;
                width: auto !important;
                height: auto !important;
                max-width: none;
                max-height: none;
                border-radius: 20px 20px 0 0;
            }
            
            .notification-center {
                top: 60px;
                right: 10px;
                left: 10px;
                width: auto;
                max-height: 70vh;
            }
            
            .modal-content {
                padding: 2rem;
            }
            
            .modal-buttons {
                flex-direction: column;
            }
            
            .modal-button {
                width: 100%;
            }
        }

        /* === СИСТЕМНЫЕ УТИЛИТЫ === */
        .system-utilities {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1.5rem;
            padding: 1.5rem;
        }
        
        .utility-card {
            background: #0f172a;
            border-radius: 16px;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid transparent;
            min-height: 180px;
        }
        
        .utility-card:hover {
            background: rgba(59, 130, 246, 0.1);
            transform: translateY(-5px);
            border-color: rgba(59, 130, 246, 0.3);
        }
        
        .utility-icon {
            font-size: 3rem;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .utility-name {
            font-size: 1.2rem;
            font-weight: 700;
            color: #f1f5f9;
            margin-bottom: 0.5rem;
        }
        
        .utility-desc {
            font-size: 0.9rem;
            color: #94a3b8;
            line-height: 1.4;
        }

        /* === ИГРЫ === */
        .games-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            gap: 1.5rem;
        }
        
        .game-card {
            background: #0f172a;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid #334155;
        }
        
        .game-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.5);
            border-color: rgba(59, 130, 246, 0.5);
        }
        
        .game-cover {
            height: 200px;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            position: relative;
            overflow: hidden;
        }
        
        .game-cover::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, 
                transparent, 
                rgba(0, 0, 0, 0.7));
        }
        
        .game-play {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            z-index: 2;
            opacity: 0;
            transition: all 0.3s;
        }
        
        .game-card:hover .game-play {
            opacity: 1;
        }
        
        .game-info {
            padding: 1.5rem;
        }
        
        .game-title {
            font-weight: 800;
            color: #f1f5f9;
            font-size: 1.3rem;
            margin-bottom: 0.8rem;
        }
        
        .game-desc {
            color: #94a3b8;
            font-size: 0.95rem;
            line-height: 1.5;
            margin-bottom: 1.5rem;
        }
        
        .game-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .game-rating {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #fbbf24;
        }
        
        .game-size {
            color: #64748b;
            font-size: 0.9rem;
        }

        /* === ОБЛАЧНОЕ ХРАНИЛИЩЕ === */
        .cloud-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            gap: 1.5rem;
        }
        
        .cloud-storage {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #0f172a;
            padding: 2rem;
            border-radius: 16px;
        }
        
        .storage-info {
            display: flex;
            align-items: center;
            gap: 2rem;
        }
        
        .storage-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2.5rem;
        }
        
        .storage-details {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .storage-name {
            font-size: 1.8rem;
            font-weight: 800;
            color: #f1f5f9;
        }
        
        .storage-used {
            color: #94a3b8;
            font-size: 1.1rem;
        }
        
        .storage-bar-container {
            flex: 1;
            max-width: 400px;
        }
        
        .storage-bar {
            height: 12px;
            background: #334155;
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 0.8rem;
        }
        
        .storage-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            border-radius: 6px;
            transition: width 1s ease-in-out;
        }
        
        .cloud-files {
            flex: 1;
            background: #0f172a;
            border-radius: 16px;
            padding: 2rem;
            overflow-y: auto;
        }
        
        .file-upload {
            border: 2px dashed #475569;
            border-radius: 16px;
            padding: 3rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 2rem;
        }
        
        .file-upload:hover {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.05);
        }
        
        .upload-icon {
            font-size: 4rem;
            color: #3b82f6;
            margin-bottom: 1.5rem;
        }
        
        .upload-text {
            font-size: 1.2rem;
            color: #f1f5f9;
            margin-bottom: 0.5rem;
        }
        
        .upload-hint {
            color: #94a3b8;
            font-size: 1rem;
        }
    </style>
</head>
<body>
    <!-- Экран загрузки -->
    <div id="boot-screen">
        <div class="boot-logo">AFAGOS</div>
        <div class="boot-subtitle">Полнофункциональная веб-операционная система</div>
        <div class="boot-loader">
            <div class="boot-loader-bar" id="boot-progress-bar"></div>
        </div>
        <div class="boot-message" id="boot-message">Инициализация системы...</div>
        <div class="boot-progress" id="boot-progress">0%</div>
    </div>
    
    <!-- Экран первоначальной настройки -->
    <div id="setup-screen">
        <div class="setup-container">
            <div class="setup-header">
                <div class="setup-title">Добро пожаловать в AfagOS</div>
                <div class="setup-subtitle">Давайте настроим вашу персональную операционную систему</div>
            </div>
            
            <div class="setup-steps-container" id="setup-steps">
                <!-- Шаги будут добавляться динамически -->
            </div>
            
            <div class="setup-progress-container">
                <div class="setup-progress-text">
                    <span id="setup-step-text">Шаг 1 из 4</span>
                    <span id="setup-step-percent">25%</span>
                </div>
                <div class="setup-progress">
                    <div class="setup-progress-bar" id="setup-progress-bar"></div>
                </div>
            </div>
            
            <div class="setup-buttons">
                <button class="setup-button back" id="setup-back" style="display: none;">
                    <i class="fas fa-arrow-left"></i>
                    Назад
                </button>
                <button class="setup-button next" id="setup-next">
                    Далее
                    <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Экран блокировки -->
    <div id="lock-screen">
        <div class="lock-time" id="lock-time">00:00</div>
        <div class="lock-date" id="lock-date">Понедельник, 1 января 2024</div>
        <div class="lock-avatar">
            <i class="fas fa-user" id="lock-avatar-icon"></i>
        </div>
        <div class="lock-prompt">
            <div class="lock-username" id="lock-username">Администратор</div>
            <div class="lock-input-container">
                <i class="fas fa-key lock-input-icon"></i>
                <input type="password" class="lock-input" id="lock-input" 
                       placeholder="Введите пароль" autocomplete="off" maxlength="20">
            </div>
            <div class="lock-error" id="lock-error" style="display: none;">
                <i class="fas fa-exclamation-circle"></i>
                <span id="lock-error-text">Неверный пароль</span>
            </div>
            <button class="lock-button" id="lock-button">
                <i class="fas fa-unlock"></i>
                <span>Разблокировать систему</span>
            </button>
            <div class="lock-hint" id="lock-hint">Введите пароль для входа в систему</div>
            <div class="lock-shortcuts">
                <div class="lock-shortcut" id="lock-shutdown">
                    <i class="fas fa-power-off"></i>
                    Выключить
                </div>
                <div class="lock-shortcut" id="lock-restart">
                    <i class="fas fa-redo"></i>
                    Перезагрузка
                </div>
                <div class="lock-shortcut" id="lock-sleep">
                    <i class="fas fa-moon"></i>
                    Спящий режим
                </div>
            </div>
        </div>
    </div>
    
    <!-- Рабочий стол -->
    <div id="desktop">
        <!-- Фон рабочего стола -->
        <div id="desktop-background"></div>
        
        <!-- Область рабочего стола -->
        <div class="desktop-area" id="desktop-area">
            <div class="desktop-icons" id="desktop-icons">
                <!-- Иконки будут добавляться динамически -->
            </div>
            
            <!-- Контекстное меню рабочего стола -->
            <div class="desktop-context-menu" id="desktop-context-menu">
                <div class="context-item" id="context-refresh">
                    <i class="fas fa-redo"></i>
                    <span>Обновить</span>
                </div>
                <div class="context-item" id="context-sort">
                    <i class="fas fa-sort-alpha-down"></i>
                    <span>Упорядочить</span>
                </div>
                <div class="context-divider"></div>
                <div class="context-item" id="context-new-folder">
                    <i class="fas fa-folder-plus"></i>
                    <span>Новая папка</span>
                </div>
                <div class="context-item" id="context-new-file">
                    <i class="fas fa-file-plus"></i>
                    <span>Новый документ</span>
                </div>
                <div class="context-divider"></div>
                <div class="context-item" id="context-settings">
                    <i class="fas fa-cog"></i>
                    <span>Настройки</span>
                </div>
                <div class="context-item" id="context-wallpaper">
                    <i class="fas fa-image"></i>
                    <span>Обои рабочего стола</span>
                </div>
            </div>
        </div>
        
        <!-- Панель задач -->
        <div class="taskbar">
            <button class="start-button" id="start-button">
                <i class="fas fa-rocket"></i>
                <span>Пуск</span>
            </button>
            
            <div class="taskbar-apps" id="taskbar-apps">
                <!-- Активные приложения будут добавляться динамически -->
            </div>
            
            <div class="taskbar-center">
                <div class="taskbar-widget" id="widget-notifications" title="Центр уведомлений">
                    <i class="fas fa-bell"></i>
                    <span id="notification-count">0</span>
                </div>
                <div class="taskbar-widget" id="widget-wifi" title="Сеть">
                    <i class="fas fa-wifi"></i>
                </div>
                <div class="taskbar-widget" id="widget-sound" title="Звук">
                    <i class="fas fa-volume-up"></i>
                </div>
                <div class="taskbar-widget" id="widget-battery" title="Питание">
                    <i class="fas fa-battery-full"></i>
                </div>
            </div>
            
            <div class="taskbar-right">
                <div class="system-tray">
                    <div class="tray-icon" id="tray-settings" title="Настройки системы">
                        <i class="fas fa-cog"></i>
                    </div>
                    <div class="tray-icon" id="tray-help" title="Справка и поддержка">
                        <i class="fas fa-question-circle"></i>
                    </div>
                    <div class="tray-icon badge" id="tray-updates" title="Доступны обновления">
                        <i class="fas fa-sync-alt"></i>
                    </div>
                    <div class="tray-icon" id="tray-power" title="Питание и завершение работы">
                        <i class="fas fa-power-off"></i>
                    </div>
                </div>
                <div class="time-display" id="time-display">
                    <div class="time" id="desktop-time">00:00</div>
                    <div class="date" id="desktop-date">01.01.2024</div>
                </div>
            </div>
        </div>
        
        <!-- Меню "Пуск" -->
        <div id="start-menu">
            <div class="start-header">
                <div class="start-user">
                    <div class="start-avatar" id="start-avatar">
                        <i class="fas fa-user" id="start-avatar-icon"></i>
                    </div>
                    <div class="start-user-info">
                        <div class="start-username" id="start-username">Администратор</div>
                        <div class="start-user-role" id="start-user-role">Владелец системы</div>
                    </div>
                </div>
                <div class="start-search">
                    <input type="text" class="search-input" id="start-search" 
                           placeholder="Поиск приложений, файлов и настроек...">
                    <button class="search-button" id="start-search-button">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>
            
            <div class="start-content">
                <div class="start-sidebar">
                    <div class="start-section">
                        <div class="section-title">Часто используемые</div>
                        <div class="start-item active" data-section="pinned">
                            <i class="fas fa-thumbtack"></i>
                            <span>Закрепленные</span>
                        </div>
                        <div class="start-item" data-section="recent">
                            <i class="fas fa-history"></i>
                            <span>Недавние</span>
                        </div>
                    </div>
                    
                    <div class="start-section">
                        <div class="section-title">Категории</div>
                        <div class="start-item" data-section="apps">
                            <i class="fas fa-th-large"></i>
                            <span>Все приложения</span>
                        </div>
                        <div class="start-item" data-section="games">
                            <i class="fas fa-gamepad"></i>
                            <span>Игры</span>
                        </div>
                        <div class="start-item" data-section="utils">
                            <i class="fas fa-tools"></i>
                            <span>Утилиты</span>
                        </div>
                    </div>
                    
                    <div class="start-section">
                        <div class="section-title">Система</div>
                        <div class="start-item" data-section="settings">
                            <i class="fas fa-cog"></i>
                            <span>Настройки</span>
                        </div>
                        <div class="start-item" data-section="power">
                            <i class="fas fa-power-off"></i>
                            <span>Питание</span>
                        </div>
                    </div>
                </div>
                
                <div class="start-main" id="start-main">
                    <!-- Контент будет меняться в зависимости от выбранного раздела -->
                </div>
            </div>
            
            <div class="start-footer">
                <div class="user-status">
                    <div class="status-indicator"></div>
                    <span>В сети</span>
                </div>
                <button class="power-button" id="start-power">
                    <i class="fas fa-power-off"></i>
                    <span>Завершение работы</span>
                </button>
            </div>
        </div>
        
        <!-- Центр уведомлений -->
        <div class="notification-center" id="notification-center">
            <div class="notification-header">
                <span>Уведомления</span>
                <div class="notification-count" id="notification-count-badge">0 новых</div>
                <button class="notification-clear" id="clear-notifications">
                    <i class="fas fa-trash-alt"></i>
                    Очистить все
                </button>
            </div>
            <div class="notification-list" id="notification-list">
                <!-- Уведомления будут добавляться динамически -->
            </div>
        </div>
    </div>
    
    <!-- === ОКНА ПРИЛОЖЕНИЙ === -->
    
    <!-- 1. БРАУЗЕР -->
    <div class="app-window" id="browser-window" style="width: 1000px; height: 700px; left: 200px; top: 100px;">
        <div class="window-header">
            <div class="window-title-container">
                <div class="window-icon">
                    <i class="fas fa-globe"></i>
                </div>
                <div class="window-title">Afag Browser</div>
            </div>
            <div class="window-controls">
                <button class="window-control minimize" data-window="browser" title="Свернуть">
                    <i class="fas fa-minus"></i>
                </button>
                <button class="window-control maximize" data-window="browser" title="Развернуть">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="window-control close" data-window="browser" title="Закрыть">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="window-content">
            <div class="browser-container">
                <div class="browser-toolbar">
                    <div class="browser-controls">
                        <button class="browser-control" id="browser-back" title="Назад" disabled>
                            <i class="fas fa-arrow-left"></i>
                        </button>
                        <button class="browser-control" id="browser-forward" title="Вперед" disabled>
                            <i class="fas fa-arrow-right"></i>
                        </button>
                        <button class="browser-control" id="browser-refresh" title="Обновить">
                            <i class="fas fa-redo"></i>
                        </button>
                        <button class="browser-control" id="browser-home" title="Домашняя страница">
                            <i class="fas fa-home"></i>
                        </button>
                    </div>
                    
                    <div class="browser-url-bar">
                        <div class="url-actions">
                            <button class="url-action" title="Защищённое соединение" disabled>
                                <i class="fas fa-lock"></i>
                            </button>
                        </div>
                        <input type="text" class="url-input" id="url-input" 
                               placeholder="Введите URL или поисковый запрос"
                               value="https://www.google.com">
                        <button class="go-button" id="go-button">
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                    
                    <div class="browser-controls">
                        <button class="browser-control" id="browser-bookmarks" title="Закладки">
                            <i class="fas fa-bookmark"></i>
                        </button>
                        <button class="browser-control" id="browser-history" title="История">
                            <i class="fas fa-history"></i>
                        </button>
                        <button class="browser-control" id="browser-downloads" title="Загрузки">
                            <i class="fas fa-download"></i>
                        </button>
                        <button class="browser-control" id="browser-menu" title="Меню">
                            <i class="fas fa-ellipsis-v"></i>
                        </button>
                    </div>
                </div>
                
                <div class="browser-quick-access">
                    <div class="quick-site google" onclick="navigateToUrl('https://www.google.com')">
                        <i class="fab fa-google"></i>
                        <span>Google</span>
                    </div>
                    <div class="quick-site youtube" onclick="navigateToUrl('https://www.youtube.com')">
                        <i class="fab fa-youtube"></i>
                        <span>YouTube</span>
                    </div>
                    <div class="quick-site twitch" onclick="openTwitchBrowser()">
                        <i class="fab fa-twitch"></i>
                        <span>Twitch</span>
                    </div>
                    <div class="quick-site github" onclick="navigateToUrl('https://github.com')">
                        <i class="fab fa-github"></i>
                        <span>GitHub</span>
                    </div>
                </div>
                
                <div class="browser-tabs" id="browser-tabs">
                    <div class="browser-tab active" data-tab="0">
                        <i class="fas fa-globe"></i>
                        <span>Новая вкладка</span>
                        <div class="browser-tab-close">×</div>
                    </div>
                </div>
                
                <div class="browser-content">
                    <div class="browser-loading" id="browser-loading">
                        <div class="loading-spinner"></div>
                        <div class="loading-text">Загрузка страницы...</div>
                    </div>
                    <div id="browser-content-area">
                        <!-- Контент будет загружаться сюда -->
                    </div>
                </div>
                
                <div class="browser-status">
                    <span id="browser-status-text">Готов к работе</span>
                    <span id="browser-security">Защищено</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 2. ТЕКСТОВЫЙ РЕДАКТОР -->
    <div class="app-window" id="text-editor-window" style="width: 900px; height: 650px; left: 250px; top: 150px;">
        <div class="window-header">
            <div class="window-title-container">
                <div class="window-icon">
                    <i class="fas fa-file-alt"></i>
                </div>
                <div class="window-title">Текстовый редактор - Новый документ</div>
            </div>
            <div class="window-controls">
                <button class="window-control minimize" data-window="text-editor" title="Свернуть">
                    <i class="fas fa-minus"></i>
                </button>
                <button class="window-control maximize" data-window="text-editor" title="Развернуть">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="window-control close" data-window="text-editor" title="Закрыть">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="window-content">
            <div class="editor-container">
                <div class="editor-toolbar">
                    <div class="editor-group">
                        <button class="editor-button" id="new-document" title="Новый документ">
                            <i class="fas fa-file"></i>
                            <span>Новый</span>
                        </button>
                        <button class="editor-button" id="open-document" title="Открыть">
                            <i class="fas fa-folder-open"></i>
                            <span>Открыть</span>
                        </button>
                        <button class="editor-button" id="save-document" title="Сохранить">
                            <i class="fas fa-save"></i>
                            <span>Сохранить</span>
                        </button>
                        <button class="editor-button" id="save-as" title="Сохранить как">
                            <i class="fas fa-save"></i>
                            <span>Сохранить как</span>
                        </button>
                    </div>
                    
                    <div class="editor-group">
                        <button class="editor-button" id="undo-action" title="Отменить">
                            <i class="fas fa-undo"></i>
                            <span>Отменить</span>
                        </button>
                        <button class="editor-button" id="redo-action" title="Вернуть">
                            <i class="fas fa-redo"></i>
                            <span>Вернуть</span>
                        </button>
                    </div>
                    
                    <div class="editor-group">
                        <button class="editor-button" id="bold-text" title="Жирный">
                            <i class="fas fa-bold"></i>
                        </button>
                        <button class="editor-button" id="italic-text" title="Курсив">
                            <i class="fas fa-italic"></i>
                        </button>
                        <button class="editor-button" id="underline-text" title="Подчеркнутый">
                            <i class="fas fa-underline"></i>
                        </button>
                        <button class="editor-button" id="text-color" title="Цвет текста">
                            <i class="fas fa-palette"></i>
                        </button>
                    </div>
                    
                    <div class="editor-group">
                        <button class="editor-button" id="align-left" title="По левому краю">
                            <i class="fas fa-align-left"></i>
                        </button>
                        <button class="editor-button" id="align-center" title="По центру">
                            <i class="fas fa-align-center"></i>
                        </button>
                        <button class="editor-button" id="align-right" title="По правому краю">
                            <i class="fas fa-align-right"></i>
                        </button>
                        <button class="editor-button" id="align-justify" title="По ширине">
                            <i class="fas fa-align-justify"></i>
                        </button>
                    </div>
                    
                    <div class="editor-group">
                        <button class="editor-button" id="insert-image" title="Вставить изображение">
                            <i class="fas fa-image"></i>
                            <span>Изображение</span>
                        </button>
                        <button class="editor-button" id="insert-link" title="Вставить ссылку">
                            <i class="fas fa-link"></i>
                            <span>Ссылка</span>
                        </button>
                    </div>
                </div>
                
                <div class="editor-area-container">
                    <div class="editor-tabs">
                        <div class="editor-tab active">
                            <i class="fas fa-file-alt"></i>
                            <span>Новый документ.txt</span>
                        </div>
                    </div>
                    <div class="editor-area" id="editor-area" contenteditable="true" spellcheck="true">
Добро пожаловать в текстовый редактор AfagOS!

Это полнофункциональный редактор документов с поддержкой:

✓ Форматирование текста (жирный, курсив, подчеркивание)
✓ Различные выравнивания
✓ Вставка изображений и ссылок
✓ Сохранение и загрузка документов
✓ Поддержка различных форматов файлов

Начните печатать или используйте инструменты на панели выше для форматирования текста.

Совет: Используйте сочетания клавиш:
• Ctrl+B - Жирный текст
• Ctrl+I - Курсив
• Ctrl+U - Подчеркивание
• Ctrl+S - Сохранить
                    </div>
                </div>
                
                <div class="editor-status">
                    <span id="editor-status">Готов к работе</span>
                    <span id="editor-info">Строк: 15 | Символов: 456</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 3. МЕДИАПЛЕЕР -->
    <div class="app-window" id="media-player-window" style="width: 800px; height: 600px; left: 300px; top: 200px;">
        <div class="window-header">
            <div class="window-title-container">
                <div class="window-icon">
                    <i class="fas fa-play-circle"></i>
                </div>
                <div class="window-title">Медиаплеер</div>
            </div>
            <div class="window-controls">
                <button class="window-control minimize" data-window="media-player" title="Свернуть">
                    <i class="fas fa-minus"></i>
                </button>
                <button class="window-control maximize" data-window="media-player" title="Развернуть">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="window-control close" data-window="media-player" title="Закрыть">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="window-content">
            <div class="player-container">
                <div class="player-header">
                    <div class="player-info">
                        <div class="player-cover">
                            <i class="fas fa-music"></i>
                        </div>
                        <div class="player-details">
                            <div class="player-title" id="player-title">AfagOS Music</div>
                            <div class="player-artist" id="player-artist">Системная музыкальная библиотека</div>
                        </div>
                    </div>
                    <button class="player-button" id="player-shuffle" title="Перемешать">
                        <i class="fas fa-random"></i>
                    </button>
                </div>
                
                <div class="player-video">
                    <div class="player-placeholder">
                        <i class="fas fa-play-circle"></i>
                        <h2>Медиаплеер AfagOS</h2>
                        <p style="color: #94a3b8; margin: 1rem 0 2rem;">Выберите медиафайл для воспроизведения</p>
                        
                        <div style="display: flex; gap: 1.5rem; margin-bottom: 3rem; flex-wrap: wrap;">
                            <div class="twitch-channel" onclick="playTwitchStream('shroud')" 
                                 style="background: #9146ff; padding: 1rem 2rem; border-radius: 12px; cursor: pointer; text-align: center; min-width: 150px;">
                                <i class="fab fa-twitch" style="font-size: 2rem; margin-bottom: 0.5rem;"></i>
                                <div style="font-weight: 600;">Shroud</div>
                                <div style="font-size: 0.9rem; opacity: 0.8;">FPS стримы</div>
                            </div>
                            <div class="twitch-channel" onclick="playTwitchStream('xqc')" 
                                 style="background: #ef4444; padding: 1rem 2rem; border-radius: 12px; cursor: pointer; text-align: center; min-width: 150px;">
                                <i class="fab fa-twitch" style="font-size: 2rem; margin-bottom: 0.5rem;"></i>
                                <div style="font-weight: 600;">xQc</div>
                                <div style="font-size: 0.9rem; opacity: 0.8;">Just Chatting</div>
                            </div>
                            <div class="twitch-channel" onclick="playTwitchStream('pokimane')" 
                                 style="background: #8b5cf6; padding: 1rem 2rem; border-radius: 12px; cursor: pointer; text-align: center; min-width: 150px;">
                                <i class="fab fa-twitch" style="font-size: 2rem; margin-bottom: 0.5rem;"></i>
                                <div style="font-weight: 600;">Pokimane</div>
                                <div style="font-size: 0.9rem; opacity: 0.8;">Развлечения</div>
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 1rem;">
                            <button onclick="loadSampleVideo()" style="background: #3b82f6; color: white; border: none; padding: 1rem 2rem; border-radius: 12px; cursor: pointer; font-weight: 600;">
                                <i class="fas fa-video"></i>
                                Загрузить пример видео
                            </button>
                            <button onclick="loadSampleMusic()" style="background: #10b981; color: white; border: none; padding: 1rem 2rem; border-radius: 12px; cursor: pointer; font-weight: 600;">
                                <i class="fas fa-music"></i>
                                Загрузить пример музыки
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="player-controls">
                    <button class="player-button" id="player-prev" title="Предыдущий">
                        <i class="fas fa-step-backward"></i>
                    </button>
                    <button class="player-button play" id="player-play" title="Воспроизвести">
                        <i class="fas fa-play"></i>
                    </button>
                    <button class="player-button" id="player-next" title="Следующий">
                        <i class="fas fa-step-forward"></i>
                    </button>
                    
                    <div class="player-progress">
                        <div class="progress-bar" id="player-progress-bar">
                            <div class="progress-fill" id="player-progress-fill"></div>
                        </div>
                        <div class="progress-time">
                            <span id="player-current-time">0:00</span>
                            <span id="player-duration">0:00</span>
                        </div>
                    </div>
                    
                    <div class="player-volume">
                        <i class="fas fa-volume-up"></i>
                        <input type="range" class="player-slider" id="player-volume" min="0" max="100" value="50" title="Громкость">
                    </div>
                </div>
                
                <div class="player-playlist">
                    <div class="playlist-item active">
                        <i class="fas fa-music"></i>
                        <div>
                            <div>Системная мелодия 1</div>
                            <div style="font-size: 0.9rem; color: #94a3b8;">AfagOS • 2:45</div>
                        </div>
                    </div>
                    <div class="playlist-item">
                        <i class="fas fa-music"></i>
                        <div>
                            <div>Системная мелодия 2</div>
                            <div style="font-size: 0.9rem; color: #94a3b8;">AfagOS • 3:20</div>
                        </div>
                    </div>
                    <div class="playlist-item">
                        <i class="fas fa-music"></i>
                        <div>
                            <div>Системная мелодия 3</div>
                            <div style="font-size: 0.9rem; color: #94a3b8;">AfagOS • 4:15</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 4. МАГАЗИН ПРИЛОЖЕНИЙ -->
    <div class="app-window" id="app-store-window" style="width: 1000px; height: 700px; left: 200px; top: 150px;">
        <div class="window-header">
            <div class="window-title-container">
                <div class="window-icon">
                    <i class="fas fa-shopping-cart"></i>
                </div>
                <div class="window-title">Магазин приложений AfagOS</div>
            </div>
            <div class="window-controls">
                <button class="window-control minimize" data-window="app-store" title="Свернуть">
                    <i class="fas fa-minus"></i>
                </button>
                <button class="window-control maximize" data-window="app-store" title="Развернуть">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="window-control close" data-window="app-store" title="Закрыть">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="window-content">
            <div class="app-store-container">
                <div class="app-store-header">
                    <div class="app-store-search">
                        <input type="text" class="store-search-input" id="store-search" 
                               placeholder="Поиск приложений, игр и утилит...">
                        <button class="install-button" id="store-search-button" style="min-width: 50px; padding: 1rem;">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                    <div style="display: flex; align-items: center; gap: 1.5rem;">
                        <div style="font-weight: 600; color: #f1f5f9;">Баланс:</div>
                        <div class="price-tag" id="store-balance">1000 ₽</div>
                    </div>
                </div>
                
                <div class="store-categories">
                    <div class="store-category active" data-category="all">Все</div>
                    <div class="store-category" data-category="games">Игры</div>
                    <div class="store-category" data-category="utils">Утилиты</div>
                    <div class="store-category" data-category="media">Медиа</div>
                    <div class="store-category" data-category="productivity">Производительность</div>
                    <div class="store-category" data-category="education">Образование</div>
                    <div class="store-category" data-category="internet">Интернет</div>
                </div>
                
                <div class="app-grid" id="app-store-grid">
                    <!-- Приложения будут добавляться динамически -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- 5. НАСТРОЙКИ СИСТЕМЫ -->
    <div class="app-window" id="settings-window" style="width: 900px; height: 650px; left: 250px; top: 100px;">
        <div class="window-header">
            <div class="window-title-container">
                <div class="window-icon">
                    <i class="fas fa-cog"></i>
                </div>
                <div class="window-title">Настройки системы</div>
            </div>
            <div class="window-controls">
                <button class="window-control minimize" data-window="settings" title="Свернуть">
                    <i class="fas fa-minus"></i>
                </button>
                <button class="window-control maximize" data-window="settings" title="Развернуть">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="window-control close" data-window="settings" title="Закрыть">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="window-content">
            <div class="settings-container">
                <div class="settings-sidebar">
                    <div class="settings-category">
                        <div class="category-title">Система</div>
                        <ul class="settings-list">
                            <li class="settings-item active" data-tab="system-info">
                                <i class="fas fa-info-circle"></i>
                                <span>Информация о системе</span>
                            </li>
                            <li class="settings-item" data-tab="display">
                                <i class="fas fa-desktop"></i>
                                <span>Дисплей</span>
                            </li>
                            <li class="settings-item" data-tab="sound">
                                <i class="fas fa-volume-up"></i>
                                <span>Звук</span>
                            </li>
                            <li class="settings-item" data-tab="network">
                                <i class="fas fa-wifi"></i>
                                <span>Сеть</span>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="settings-category">
                        <div class="category-title">Устройства</div>
                        <ul class="settings-list">
                            <li class="settings-item" data-tab="bluetooth">
                                <i class="fas fa-bluetooth"></i>
                                <span>Bluetooth</span>
                            </li>
                            <li class="settings-item" data-tab="printers">
                                <i class="fas fa-print"></i>
                                <span>Принтеры</span>
                            </li>
                            <li class="settings-item" data-tab="storage">
                                <i class="fas fa-hdd"></i>
                                <span>Хранилище</span>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="settings-category">
                        <div class="category-title">Персонализация</div>
                        <ul class="settings-list">
                            <li class="settings-item" data-tab="theme">
                                <i class="fas fa-palette"></i>
                                <span>Темы</span>
                            </li>
                            <li class="settings-item" data-tab="wallpaper">
                                <i class="fas fa-image"></i>
                                <span>Обои</span>
                            </li>
                            <li class="settings-item" data-tab="taskbar">
                                <i class="fas fa-sliders-h"></i>
                                <span>Панель задач</span>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="settings-category">
                        <div class="category-title">Учетные записи</div>
                        <ul class="settings-list">
                            <li class="settings-item" data-tab="account">
                                <i class="fas fa-user"></i>
                                <span>Ваша учетная запись</span>
                            </li>
                            <li class="settings-item" data-tab="family">
                                <i class="fas fa-users"></i>
                                <span>Семья и другие пользователи</span>
                            </li>
                            <li class="settings-item" data-tab="sync">
                                <i class="fas fa-sync-alt"></i>
                                <span>Синхронизация</span>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="settings-category">
                        <div class="category-title">Обновление и безопасность</div>
                        <ul class="settings-list">
                            <li class="settings-item" data-tab="updates">
                                <i class="fas fa-sync-alt"></i>
                                <span>Обновления</span>
                            </li>
                            <li class="settings-item" data-tab="security">
                                <i class="fas fa-shield-alt"></i>
                                <span>Безопасность</span>
                            </li>
                            <li class="settings-item" data-tab="backup">
                                <i class="fas fa-save"></i>
                                <span>Резервное копирование</span>
                            </li>
                        </ul>
                    </div>
                </div>
                
                <div class="settings-content" id="settings-content">
                    <div class="settings-section" id="system-info">
                        <div class="section-header">
                            <div class="section-title">Информация о системе</div>
                            <div class="section-description">
                                Просмотр информации о вашем устройстве, процессоре, памяти и операционной системе.
                            </div>
                        </div>
                        
                        <div class="settings-group">
                            <div class="group-title">Характеристики устройства</div>
                            <div class="settings-option">
                                <div class="option-info">
                                    <div class="option-title">Устройство</div>
                                    <div class="option-description">AfagOS Personal Computer</div>
                                </div>
                            </div>
                            <div class="settings-option">
                                <div class="option-info">
                                    <div class="option-title">Процессор</div>
                                    <div class="option-description">Virtual CPU @ 3.5 GHz (8 ядер)</div>
                                </div>
                            </div>
                            <div class="settings-option">
                                <div class="option-info">
                                    <div class="option-title">Оперативная память</div>
                                    <div class="option-description">16.0 ГБ DDR4</div>
                                </div>
                            </div>
                            <div class="settings-option">
                                <div class="option-info">
                                    <div class="option-title">Тип системы</div>
                                    <div class="option-description">64-разрядная операционная система, процессор x64</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="settings-group">
                            <div class="group-title">Windows</div>
                            <div class="settings-option">
                                <div class="option-info">
                                    <div class="option-title">Выпуск</div>
                                    <div class="option-description">AfagOS Professional</div>
                                </div>
                            </div>
                            <div class="settings-option">
                                <div class="option-info">
                                    <div class="option-title">Версия</div>
                                    <div class="option-description">22H2 (Сборка 19045.3086)</div>
                                </div>
                            </div>
                            <div class="settings-option">
                                <div class="option-info">
                                    <div class="option-title">Установлено</div>
                                    <div class="option-description">1 января 2024 г.</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Другие разделы настроек будут заполняться динамически -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- 6. КАЛЬКУЛЯТОР -->
    <div class="app-window" id="calculator-window" style="width: 450px; height: 600px; left: 400px; top: 200px;">
        <div class="window-header">
            <div class="window-title-container">
                <div class="window-icon">
                    <i class="fas fa-calculator"></i>
                </div>
                <div class="window-title">Калькулятор</div>
            </div>
            <div class="window-controls">
                <button class="window-control minimize" data-window="calculator" title="Свернуть">
                    <i class="fas fa-minus"></i>
                </button>
                <button class="window-control maximize" data-window="calculator" title="Развернуть">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="window-control close" data-window="calculator" title="Закрыть">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="window-content">
            <div class="calculator">
                <div class="calculator-display">
                    <div class="calc-history" id="calc-history"></div>
                    <div class="calc-current" id="calc-current">0</div>
                </div>
                
                <div class="calculator-buttons" id="calculator-buttons">
                    <!-- Кнопки будут добавлены динамически -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- 7. ФАЙЛОВЫЙ МЕНЕДЖЕР -->
    <div class="app-window" id="file-manager-window" style="width: 1000px; height: 700px; left: 150px; top: 100px;">
        <div class="window-header">
            <div class="window-title-container">
                <div class="window-icon">
                    <i class="fas fa-folder"></i>
                </div>
                <div class="window-title">Файловый менеджер</div>
            </div>
            <div class="window-controls">
                <button class="window-control minimize" data-window="file-manager" title="Свернуть">
                    <i class="fas fa-minus"></i>
                </button>
                <button class="window-control maximize" data-window="file-manager" title="Развернуть">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="window-control close" data-window="file-manager" title="Закрыть">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="window-content">
            <div class="file-manager">
                <div class="file-sidebar">
                    <div class="file-quick-access">
                        <div class="file-access-item active">
                            <i class="fas fa-home"></i>
                            <span>Этот компьютер</span>
                        </div>
                        <div class="file-access-item">
                            <i class="fas fa-desktop"></i>
                            <span>Рабочий стол</span>
                        </div>
                        <div class="file-access-item">
                            <i class="fas fa-folder"></i>
                            <span>Документы</span>
                        </div>
                        <div class="file-access-item">
                            <i class="fas fa-images"></i>
                            <span>Изображения</span>
                        </div>
                        <div class="file-access-item">
                            <i class="fas fa-music"></i>
                            <span>Музыка</span>
                        </div>
                        <div class="file-access-item">
                            <i class="fas fa-film"></i>
                            <span>Видео</span>
                        </div>
                        <div class="file-access-item">
                            <i class="fas fa-download"></i>
                            <span>Загрузки</span>
                        </div>
                    </div>
                    
                    <div class="file-storage">
                        <div class="storage-item">
                            <div class="storage-label">
                                <span>Локальный диск (C:)</span>
                                <span>85%</span>
                            </div>
                            <div class="storage-bar">
                                <div class="storage-fill" style="width: 85%;"></div>
                            </div>
                        </div>
                        <div class="storage-item">
                            <div class="storage-label">
                                <span>Локальный диск (D:)</span>
                                <span>42%</span>
                            </div>
                            <div class="storage-bar">
                                <div class="storage-fill" style="width: 42%;"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="file-content">
                    <div class="file-toolbar">
                        <button class="file-button" id="file-back">
                            <i class="fas fa-arrow-left"></i>
                            <span>Назад</span>
                        </button>
                        <button class="file-button" id="file-forward">
                            <i class="fas fa-arrow-right"></i>
                            <span>Вперед</span>
                        </button>
                        <button class="file-button" id="file-up">
                            <i class="fas fa-arrow-up"></i>
                            <span>Вверх</span>
                        </button>
                        <button class="file-button" id="file-refresh">
                            <i class="fas fa-redo"></i>
                            <span>Обновить</span>
                        </button>
                        <button class="file-button" id="file-new-folder">
                            <i class="fas fa-folder-plus"></i>
                            <span>Новая папка</span>
                        </button>
                        <button class="file-button" id="file-new-file">
                            <i class="fas fa-file-plus"></i>
                            <span>Новый файл</span>
                        </button>
                    </div>
                    
                    <div class="file-path" id="file-path">
                        <div class="path-item">Этот компьютер</div>
                        <div class="path-separator">></div>
                        <div class="path-item">Локальный диск (C:)</div>
                        <div class="path-separator">></div>
                        <div class="path-item">Пользователи</div>
                    </div>
                    
                    <div class="file-grid" id="file-grid">
                        <div class="file-item">
                            <i class="fas fa-folder file-icon"></i>
                            <div class="file-name">Документы</div>
                        </div>
                        <div class="file-item">
                            <i class="fas fa-folder file-icon"></i>
                            <div class="file-name">Загрузки</div>
                        </div>
                        <div class="file-item">
                            <i class="fas fa-folder file-icon"></i>
                            <div class="file-name">Изображения</div>
                        </div>
                        <div class="file-item">
                            <i class="fas fa-folder file-icon"></i>
                            <div class="file-name">Музыка</div>
                        </div>
                        <div class="file-item">
                            <i class="fas fa-folder file-icon"></i>
                            <div class="file-name">Видео</div>
                        </div>
                        <div class="file-item">
                            <i class="fas fa-file-alt file-icon"></i>
                            <div class="file-name">readme.txt</div>
                            <div class="file-size">2.4 КБ</div>
                        </div>
                        <div class="file-item">
                            <i class="fas fa-file-image file-icon"></i>
                            <div class="file-name">wallpaper.jpg</div>
                            <div class="file-size">4.2 МБ</div>
                        </div>
                        <div class="file-item">
                            <i class="fas fa-file-pdf file-icon"></i>
                            <div class="file-name">manual.pdf</div>
                            <div class="file-size">15.7 МБ</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 8. ГРАФИЧЕСКИЙ РЕДАКТОР -->
    <div class="app-window" id="paint-window" style="width: 900px; height: 650px; left: 250px; top: 150px;">
        <div class="window-header">
            <div class="window-title-container">
                <div class="window-icon">
                    <i class="fas fa-paint-brush"></i>
                </div>
                <div class="window-title">Графический редактор</div>
            </div>
            <div class="window-controls">
                <button class="window-control minimize" data-window="paint" title="Свернуть">
                    <i class="fas fa-minus"></i>
                </button>
                <button class="window-control maximize" data-window="paint" title="Развернуть">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="window-control close" data-window="paint" title="Закрыть">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="window-content">
            <div class="paint-container">
                <div class="paint-toolbar">
                    <div class="paint-tools">
                        <div class="paint-tool active" data-tool="brush">
                            <i class="fas fa-paint-brush"></i>
                        </div>
                        <div class="paint-tool" data-tool="pencil">
                            <i class="fas fa-pencil-alt"></i>
                        </div>
                        <div class="paint-tool" data-tool="eraser">
                            <i class="fas fa-eraser"></i>
                        </div>
                        <div class="paint-tool" data-tool="line">
                            <i class="fas fa-grip-lines"></i>
                        </div>
                        <div class="paint-tool" data-tool="rectangle">
                            <i class="fas fa-square"></i>
                        </div>
                        <div class="paint-tool" data-tool="circle">
                            <i class="fas fa-circle"></i>
                        </div>
                        <div class="paint-tool" data-tool="text">
                            <i class="fas fa-font"></i>
                        </div>
                    </div>
                    
                    <div class="color-palette">
                        <div class="paint-color active" style="background: #000000;"></div>
                        <div class="paint-color" style="background: #3b82f6;"></div>
                        <div class="paint-color" style="background: #ef4444;"></div>
                        <div class="paint-color" style="background: #10b981;"></div>
                        <div class="paint-color" style="background: #f59e0b;"></div>
                        <div class="paint-color" style="background: #8b5cf6;"></div>
                        <div class="paint-color" style="background: #ffffff; border: 1px solid #475569;"></div>
                    </div>
                    
                    <div class="brush-size">
                        <i class="fas fa-circle" style="font-size: 0.8rem;"></i>
                        <input type="range" class="size-slider" id="brush-size" min="1" max="50" value="5">
                        <i class="fas fa-circle" style="font-size: 1.5rem;"></i>
                    </div>
                    
                    <div style="display: flex; gap: 1rem;">
                        <button class="editor-button" id="paint-new">
                            <i class="fas fa-file"></i>
                            <span>Новый</span>
                        </button>
                        <button class="editor-button" id="paint-save">
                            <i class="fas fa-save"></i>
                            <span>Сохранить</span>
                        </button>
                    </div>
                </div>
                
                <div class="paint-canvas-container">
                    <canvas class="paint-canvas" id="paint-canvas" width="800" height="500"></canvas>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 9. КАЛЕНДАРЬ -->
    <div class="app-window" id="calendar-window" style="width: 900px; height: 650px; left: 250px; top: 150px;">
        <div class="window-header">
            <div class="window-title-container">
                <div class="window-icon">
                    <i class="fas fa-calendar"></i>
                </div>
                <div class="window-title">Календарь</div>
            </div>
            <div class="window-controls">
                <button class="window-control minimize" data-window="calendar" title="Свернуть">
                    <i class="fas fa-minus"></i>
                </button>
                <button class="window-control maximize" data-window="calendar" title="Развернуть">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="window-control close" data-window="calendar" title="Закрыть">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="window-content">
            <div class="calendar-container">
                <div class="calendar-header">
                    <div class="calendar-nav">
                        <button class="nav-button" id="calendar-prev-year">
                            <i class="fas fa-angle-double-left"></i>
                        </button>
                        <button class="nav-button" id="calendar-prev-month">
                            <i class="fas fa-angle-left"></i>
                        </button>
                        <div class="calendar-title" id="calendar-title">Январь 2024</div>
                        <button class="nav-button" id="calendar-next-month">
                            <i class="fas fa-angle-right"></i>
                        </button>
                        <button class="nav-button" id="calendar-next-year">
                            <i class="fas fa-angle-double-right"></i>
                        </button>
                    </div>
                    <button class="install-button" id="calendar-new-event">
                        <i class="fas fa-plus"></i>
                        <span>Новое событие</span>
                    </button>
                </div>
                
                <div class="calendar-grid">
                    <div class="calendar-weekdays">
                        <div class="weekday">Пн</div>
                        <div class="weekday">Вт</div>
                        <div class="weekday">Ср</div>
                        <div class="weekday">Чт</div>
                        <div class="weekday">Пт</div>
                        <div class="weekday">Сб</div>
                        <div class="weekday">Вс</div>
                    </div>
                    
                    <div class="calendar-days" id="calendar-days">
                        <!-- Дни будут добавлены динамически -->
                    </div>
                </div>
                
                <div class="calendar-events">
                    <h3 style="margin-bottom: 1rem;">Предстоящие события</h3>
                    <div class="notification-item">
                        <div class="notification-title">
                            <span>Совещание по проекту</span>
                            <span class="notification-time">Сегодня, 14:00</span>
                        </div>
                        <div class="notification-message">Обсуждение нового проекта с командой разработки</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 10. ЗАМЕТКИ -->
    <div class="app-window" id="notes-window" style="width: 900px; height: 650px; left: 250px; top: 150px;">
        <div class="window-header">
            <div class="window-title-container">
                <div class="window-icon">
                    <i class="fas fa-sticky-note"></i>
                </div>
                <div class="window-title">Заметки</div>
            </div>
            <div class="window-controls">
                <button class="window-control minimize" data-window="notes" title="Свернуть">
                    <i class="fas fa-minus"></i>
                </button>
                <button class="window-control maximize" data-window="notes" title="Развернуть">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="window-control close" data-window="notes" title="Закрыть">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="window-content">
            <div class="notes-container">
                <div class="notes-sidebar">
                    <button class="install-button" id="notes-new" style="width: 100%;">
                        <i class="fas fa-plus"></i>
                        <span>Новая заметка</span>
                    </button>
                    
                    <div class="notes-list" id="notes-list">
                        <div class="note-item active">
                            <div class="note-title">Добро пожаловать в AfagOS</div>
                            <div class="note-preview">Приветствуем вас в нашей операционной системе! Это демонстрационная заметка...</div>
                            <div class="note-date">Сегодня, 10:30</div>
                        </div>
                        <div class="note-item">
                            <div class="note-title">Список задач</div>
                            <div class="note-preview">1. Запустить браузер 2. Проверить почту 3. Подготовить отчет...</div>
                            <div class="note-date">Вчера, 15:45</div>
                        </div>
                    </div>
                </div>
                
                <div class="notes-editor">
                    <div class="editor-header">
                        <input type="text" class="note-title-input" id="note-title" placeholder="Название заметки" value="Добро пожаловать в AfagOS">
                        <button class="install-button" id="notes-save">
                            <i class="fas fa-save"></i>
                            <span>Сохранить</span>
                        </button>
                    </div>
                    
                    <textarea class="note-editor" id="note-editor" placeholder="Начните печатать вашу заметку...">
Приветствуем вас в AfagOS - полнофункциональной веб-операционной системе!

Функции заметок:
✓ Создание и редактирование заметок
✓ Автосохранение
✓ Форматирование текста
✓ Поиск по заметкам
✓ Организация по категориям

Советы:
• Используйте #теги для организации заметок
• Добавляйте важные даты и напоминания
• Экспортируйте заметки в формате TXT или PDF

Наслаждайтесь использованием системы!
                    </textarea>
                    
                    <div class="editor-tools">
                        <div style="display: flex; gap: 1rem;">
                            <button class="editor-button" id="notes-bold">
                                <i class="fas fa-bold"></i>
                            </button>
                            <button class="editor-button" id="notes-italic">
                                <i class="fas fa-italic"></i>
                            </button>
                            <button class="editor-button" id="notes-underline">
                                <i class="fas fa-underline"></i>
                            </button>
                        </div>
                        <button class="editor-button" id="notes-delete">
                            <i class="fas fa-trash-alt"></i>
                            <span>Удалить</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 11. СИСТЕМНЫЙ МОНИТОР -->
    <div class="app-window" id="monitor-window" style="width: 900px; height: 650px; left: 250px; top: 150px;">
        <div class="window-header">
            <div class="window-title-container">
                <div class="window-icon">
                    <i class="fas fa-chart-bar"></i>
                </div>
                <div class="window-title">Системный монитор</div>
            </div>
            <div class="window-controls">
                <button class="window-control minimize" data-window="monitor" title="Свернуть">
                    <i class="fas fa-minus"></i>
                </button>
                <button class="window-control maximize" data-window="monitor" title="Развернуть">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="window-control close" data-window="monitor" title="Закрыть">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="window-content">
            <div class="monitor-container">
                <div class="monitor-stats">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-title">ЦП</div>
                            <div class="stat-value" id="cpu-usage">24%</div>
                        </div>
                        <div class="stat-progress">
                            <div class="stat-progress-bar" id="cpu-bar" style="width: 24%;"></div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-title">Память</div>
                            <div class="stat-value" id="memory-usage">58%</div>
                        </div>
                        <div class="stat-progress">
                            <div class="stat-progress-bar" id="memory-bar" style="width: 58%;"></div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-title">Диск</div>
                            <div class="stat-value" id="disk-usage">42%</div>
                        </div>
                        <div class="stat-progress">
                            <div class="stat-progress-bar" id="disk-bar" style="width: 42%;"></div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-title">Сеть</div>
                            <div class="stat-value" id="network-usage">1.2 МБ/с</div>
                        </div>
                        <div class="stat-progress">
                            <div class="stat-progress-bar" id="network-bar" style="width: 60%;"></div>
                        </div>
                    </div>
                </div>
                
                <div class="monitor-charts">
                    <div class="chart-container">
                        <div class="chart-title">Использование ЦП</div>
                        <div class="chart">
                            <div class="chart-line" id="cpu-chart">
                                <!-- График будет отрисован динамически -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <div class="chart-title">Использование памяти</div>
                        <div class="chart">
                            <div class="chart-line" id="memory-chart">
                                <!-- График будет отрисован динамически -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 12. ТЕРМИНАЛ -->
    <div class="app-window" id="terminal-window" style="width: 800px; height: 550px; left: 300px; top: 200px;">
        <div class="window-header">
            <div class="window-title-container">
                <div class="window-icon">
                    <i class="fas fa-terminal"></i>
                </div>
                <div class="window-title">Терминал</div>
            </div>
            <div class="window-controls">
                <button class="window-control minimize" data-window="terminal" title="Свернуть">
                    <i class="fas fa-minus"></i>
                </button>
                <button class="window-control maximize" data-window="terminal" title="Развернуть">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="window-control close" data-window="terminal" title="Закрыть">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="window-content">
            <div style="background: #0f172a; border-radius: 12px; padding: 1.5rem; height: 100%; display: flex; flex-direction: column;">
                <div style="color: #10b981; font-family: 'Courier New', monospace; margin-bottom: 1rem;">
                    <i class="fas fa-user"></i>
                    <span id="terminal-user">user@afagos</span>
                    <span style="color: #3b82f6;">~</span>
                    <span style="color: white;">$</span>
                </div>
                
                <div id="terminal-output" style="flex: 1; overflow-y: auto; font-family: 'Courier New', monospace; color: #e2e8f0; line-height: 1.5; margin-bottom: 1rem;">
                    <div>Добро пожаловать в терминал AfagOS!</div>
                    <div>Введите 'help' для списка доступных команд.</div>
                    <br>
                    <div class="terminal-line">
                        <span style="color: #10b981;">user@afagos</span>
                        <span style="color: #3b82f6;">~</span>
                        <span style="color: white;">$</span>
                        <span style="margin-left: 0.5rem;">help</span>
                    </div>
                    <div>Доступные команды:</div>
                    <div>  help - показать эту справку</div>
                    <div>  clear - очистить экран</div>
                    <div>  date - показать текущую дату и время</div>
                    <div>  echo [текст] - вывести текст</div>
                    <div>  ls - список файлов</div>
                    <div>  pwd - текущая директория</div>
                    <div>  neofetch - информация о системе</div>
                    <br>
                </div>
                
                <div style="display: flex; align-items: center; font-family: 'Courier New', monospace;">
                    <div style="color: #10b981;">
                        <i class="fas fa-user"></i>
                        <span id="terminal-prompt-user">user@afagos</span>
                        <span style="color: #3b82f6;">~</span>
                        <span style="color: white;">$</span>
                    </div>
                    <input type="text" id="terminal-input" 
                           style="flex: 1; background: transparent; border: none; color: white; font-family: inherit; font-size: 1rem; margin-left: 0.5rem; outline: none;"
                           autocomplete="off" spellcheck="false">
                </div>
            </div>
        </div>
    </div>
    
    <!-- 13. ПОЧТОВЫЙ КЛИЕНТ -->
    <div class="app-window" id="mail-window" style="width: 900px; height: 650px; left: 250px; top: 150px;">
        <div class="window-header">
            <div class="window-title-container">
                <div class="window-icon">
                    <i class="fas fa-envelope"></i>
                </div>
                <div class="window-title">Почта</div>
            </div>
            <div class="window-controls">
                <button class="window-control minimize" data-window="mail" title="Свернуть">
                    <i class="fas fa-minus"></i>
                </button>
                <button class="window-control maximize" data-window="mail" title="Развернуть">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="window-control close" data-window="mail" title="Закрыть">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="window-content">
            <div style="display: flex; height: 100%; gap: 1.5rem;">
                <div style="width: 250px; background: #0f172a; border-radius: 16px; padding: 1.5rem; display: flex; flex-direction: column; gap: 1.5rem;">
                    <button class="install-button" id="mail-compose" style="width: 100%;">
                        <i class="fas fa-plus"></i>
                        <span>Написать</span>
                    </button>
                    
                    <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                        <div class="file-access-item active">
                            <i class="fas fa-inbox"></i>
                            <span>Входящие</span>
                            <span style="margin-left: auto; background: #3b82f6; color: white; padding: 0.2rem 0.6rem; border-radius: 10px; font-size: 0.8rem;">3</span>
                        </div>
                        <div class="file-access-item">
                            <i class="fas fa-envelope"></i>
                            <span>Отправленные</span>
                        </div>
                        <div class="file-access-item">
                            <i class="fas fa-pen"></i>
                            <span>Черновики</span>
                        </div>
                        <div class="file-access-item">
                            <i class="fas fa-trash-alt"></i>
                            <span>Корзина</span>
                        </div>
                    </div>
                </div>
                
                <div style="flex: 1; background: #0f172a; border-radius: 16px; padding: 1.5rem; display: flex; flex-direction: column;">
                    <div style="font-size: 1.5rem; font-weight: 700; color: #f1f5f9; margin-bottom: 1.5rem;">Входящие</div>
                    
                    <div style="flex: 1; overflow-y: auto;">
                        <div class="notification-item" style="cursor: pointer;">
                            <div class="notification-title">
                                <span>Команда AfagOS</span>
                                <span class="notification-time">Сегодня, 09:15</span>
                            </div>
                            <div class="notification-message">Добро пожаловать в AfagOS! Узнайте о новых функциях системы...</div>
                        </div>
                        
                        <div class="notification-item" style="cursor: pointer;">
                            <div class="notification-title">
                                <span>Поддержка системы</span>
                                <span class="notification-time">Вчера, 14:30</span>
                            </div>
                            <div class="notification-message">Ваше обращение в службу поддержки зарегистрировано под номером #15432</div>
                        </div>
                        
                        <div class="notification-item" style="cursor: pointer;">
                            <div class="notification-title">
                                <span>Обновления системы</span>
                                <span class="notification-time">2 дня назад</span>
                            </div>
                            <div class="notification-message">Доступны обновления безопасности для AfagOS. Рекомендуем установить...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 14. ИГРА: ТЕТРИС -->
    <div class="app-window" id="tetris-window" style="width: 600px; height: 700px; left: 350px; top: 100px;">
        <div class="window-header">
            <div class="window-title-container">
                <div class="window-icon">
                    <i class="fas fa-gamepad"></i>
                </div>
                <div class="window-title">Тетрис</div>
            </div>
            <div class="window-controls">
                <button class="window-control minimize" data-window="tetris" title="Свернуть">
                    <i class="fas fa-minus"></i>
                </button>
                <button class="window-control maximize" data-window="tetris" title="Развернуть">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="window-control close" data-window="tetris" title="Закрыть">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="window-content">
            <div style="display: flex; height: 100%; gap: 2rem;">
                <div style="flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                    <canvas id="tetris-canvas" width="300" height="600" 
                            style="background: #0f172a; border: 2px solid #475569; border-radius: 8px;"></canvas>
                </div>
                
                <div style="width: 250px; background: #0f172a; border-radius: 16px; padding: 2rem; display: flex; flex-direction: column; gap: 2rem;">
                    <div>
                        <div style="font-size: 2rem; font-weight: 800; color: #f1f5f9; text-align: center; margin-bottom: 1rem;">ТЕТРИС</div>
                        <div style="text-align: center; color: #94a3b8;">Классическая игра в AfagOS</div>
                    </div>
                    
                    <div>
                        <div style="font-size: 1.2rem; font-weight: 700; color: #f1f5f9; margin-bottom: 1rem;">Счет</div>
                        <div style="font-size: 3rem; font-weight: 800; color: #3b82f6; text-align: center;" id="tetris-score">0</div>
                    </div>
                    
                    <div>
                        <div style="font-size: 1.2rem; font-weight: 700; color: #f1f5f9; margin-bottom: 1rem;">Уровень</div>
                        <div style="font-size: 2.5rem; font-weight: 800; color: #10b981; text-align: center;" id="tetris-level">1</div>
                    </div>
                    
                    <div>
                        <div style="font-size: 1.2rem; font-weight: 700; color: #f1f5f9; margin-bottom: 1rem;">Следующая фигура</div>
                        <div style="height: 100px; background: rgba(30, 41, 59, 0.5); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                            <canvas id="tetris-next" width="80" height="80"></canvas>
                        </div>
                    </div>
                    
                    <div style="margin-top: auto;">
                        <button class="install-button" id="tetris-start" style="width: 100%;">
                            <i class="fas fa-play"></i>
                            <span>Начать игру</span>
                        </button>
                        <button class="editor-button" id="tetris-pause" style="width: 100%; margin-top: 1rem;">
                            <i class="fas fa-pause"></i>
                            <span>Пауза</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 15. ОБЛАЧНОЕ ХРАНИЛИЩЕ -->
    <div class="app-window" id="cloud-window" style="width: 900px; height: 650px; left: 250px; top: 150px;">
        <div class="window-header">
            <div class="window-title-container">
                <div class="window-icon">
                    <i class="fas fa-cloud"></i>
                </div>
                <div class="window-title">Облачное хранилище</div>
            </div>
            <div class="window-controls">
                <button class="window-control minimize" data-window="cloud" title="Свернуть">
                    <i class="fas fa-minus"></i>
                </button>
                <button class="window-control maximize" data-window="cloud" title="Развернуть">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="window-control close" data-window="cloud" title="Закрыть">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="window-content">
            <div class="cloud-container">
                <div class="cloud-storage">
                    <div class="storage-info">
                        <div class="storage-icon">
                            <i class="fas fa-cloud"></i>
                        </div>
                        <div class="storage-details">
                            <div class="storage-name">Afag Cloud</div>
                            <div class="storage-used">Использовано 15.4 ГБ из 100 ГБ</div>
                        </div>
                    </div>
                    
                    <div class="storage-bar-container">
                        <div class="storage-bar">
                            <div class="storage-fill" style="width: 15.4%;"></div>
                        </div>
                        <div style="text-align: right; color: #94a3b8; font-size: 0.9rem;">15.4 ГБ / 100 ГБ</div>
                    </div>
                </div>
                
                <div class="cloud-files">
                    <div class="file-upload" id="cloud-upload">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <div class="upload-text">Загрузить файлы</div>
                        <div class="upload-hint">Перетащите файлы сюда или нажмите для выбора</div>
                    </div>
                    
                    <div class="file-grid">
                        <div class="file-item">
                            <i class="fas fa-folder file-icon"></i>
                            <div class="file-name">Документы</div>
                        </div>
                        <div class="file-item">
                            <i class="fas fa-folder file-icon"></i>
                            <div class="file-name">Фотографии</div>
                        </div>
                        <div class="file-item">
                            <i class="fas fa-folder file-icon"></i>
                            <div class="file-name">Музыка</div>
                        </div>
                        <div class="file-item">
                            <i class="fas fa-file-image file-icon"></i>
                            <div class="file-name">Отпуск.jpg</div>
                            <div class="file-size">4.2 МБ</div>
                        </div>
                        <div class="file-item">
                            <i class="fas fa-file-pdf file-icon"></i>
                            <div class="file-name">Отчет.pdf</div>
                            <div class="file-size">8.5 МБ</div>
                        </div>
                        <div class="file-item">
                            <i class="fas fa-file-video file-icon"></i>
                            <div class="file-name">Видео.mp4</div>
                            <div class="file-size">156 МБ</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 16. ПОГОДА -->
    <div class="app-window" id="weather-window" style="width: 600px; height: 500px; left: 400px; top: 200px;">
        <div class="window-header">
            <div class="window-title-container">
                <div class="window-icon">
                    <i class="fas fa-cloud-sun"></i>
                </div>
                <div class="window-title">Погода</div>
            </div>
            <div class="window-controls">
                <button class="window-control minimize" data-window="weather" title="Свернуть">
                    <i class="fas fa-minus"></i>
                </button>
                <button class="window-control maximize" data-window="weather" title="Развернуть">
                    <i class="fas fa-expand"></i>
                </button>
                <button class="window-control close" data-window="weather" title="Закрыть">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="window-content">
            <div style="text-align: center; padding: 2rem;">
                <div style="font-size: 4rem; color: #3b82f6; margin-bottom: 1rem;">
                    <i class="fas fa-sun"></i>
                </div>
                <div style="font-size: 4rem; font-weight: 800; color: #f1f5f9; margin-bottom: 0.5rem;" id="weather-temp">+24°</div>
                <div style="font-size: 1.5rem; color: #94a3b8; margin-bottom: 2rem;" id="weather-location">Москва, Россия</div>
                
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem; margin-top: 3rem;">
                    <div style="text-align: center;">
                        <div style="font-size: 0.9rem; color: #94a3b8; margin-bottom: 0.5rem;">Влажность</div>
                        <div style="font-size: 1.5rem; font-weight: 700; color: #f1f5f9;">65%</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 0.9rem; color: #94a3b8; margin-bottom: 0.5rem;">Ветер</div>
                        <div style="font-size: 1.5rem; font-weight: 700; color: #f1f5f9;">3 м/с</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 0.9rem; color: #94a3b8; margin-bottom: 0.5rem;">Давление</div>
                        <div style="font-size: 1.5rem; font-weight: 700; color: #f1f5f9;">760 мм</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- === МОДАЛЬНЫЕ ОКНА === -->
    
    <!-- Модальное окно покупки -->
    <div class="modal" id="purchase-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Покупка приложения</div>
                <button class="modal-close" id="modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-text" id="modal-text">
                Вы уверены, что хотите купить приложение?
            </div>
            <div class="modal-buttons">
                <button class="modal-button cancel" id="cancel-purchase">Отмена</button>
                <button class="modal-button confirm" id="confirm-purchase">Купить</button>
            </div>
        </div>
    </div>
    
    <!-- Модальное окно уведомления -->
    <div class="modal" id="alert-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="alert-title">Уведомление</div>
                <button class="modal-close" id="alert-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-text" id="alert-text"></div>
            <div class="modal-buttons">
                <button class="modal-button confirm" id="alert-ok">OK</button>
            </div>
        </div>
    </div>
    
    <!-- Модальное окно завершения работы -->
    <div class="modal" id="shutdown-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Завершение работы</div>
                <button class="modal-close" id="shutdown-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-text">
                Выберите действие:
            </div>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem; margin: 2rem 0;">
                <div style="text-align: center; cursor: pointer;" id="shutdown-option">
                    <div style="width: 80px; height: 80px; background: #ef4444; border-radius: 16px; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem;">
                        <i class="fas fa-power-off" style="font-size: 2.5rem; color: white;"></i>
                    </div>
                    <div style="font-weight: 700; color: #f1f5f9;">Выключить</div>
                    <div style="color: #94a3b8; font-size: 0.9rem;">Полное выключение системы</div>
                </div>
                
                <div style="text-align: center; cursor: pointer;" id="restart-option">
                    <div style="width: 80px; height: 80px; background: #3b82f6; border-radius: 16px; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem;">
                        <i class="fas fa-redo" style="font-size: 2.5rem; color: white;"></i>
                    </div>
                    <div style="font-weight: 700; color: #f1f5f9;">Перезагрузить</div>
                    <div style="color: #94a3b8; font-size: 0.9rem;">Перезагрузка системы</div>
                </div>
                
                <div style="text-align: center; cursor: pointer;" id="sleep-option">
                    <div style="width: 80px; height: 80px; background: #8b5cf6; border-radius: 16px; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem;">
                        <i class="fas fa-moon" style="font-size: 2.5rem; color: white;"></i>
                    </div>
                    <div style="font-weight: 700; color: #f1f5f9;">Сон</div>
                    <div style="color: #94a3b8; font-size: 0.9rem;">Режим пониженного энергопотребления</div>
                </div>
                
                <div style="text-align: center; cursor: pointer;" id="logout-option">
                    <div style="width: 80px; height: 80px; background: #10b981; border-radius: 16px; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem;">
                        <i class="fas fa-sign-out-alt" style="font-size: 2.5rem; color: white;"></i>
                    </div>
                    <div style="font-weight: 700; color: #f1f5f9;">Выход</div>
                    <div style="color: #94a3b8; font-size: 0.9rem;">Выйти из учетной записи</div>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="modal-button cancel" id="shutdown-cancel">Отмена</button>
            </div>
        </div>
    </div>
    
    <!-- Контекстное меню -->
    <div class="context-menu" id="context-menu">
        <div class="context-menu-item" id="context-open">
            <i class="fas fa-folder-open"></i>
            <span>Открыть</span>
        </div>
        <div class="context-menu-item" id="context-run">
            <i class="fas fa-play"></i>
            <span>Запустить</span>
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" id="context-copy">
            <i class="fas fa-copy"></i>
            <span>Копировать</span>
        </div>
        <div class="context-menu-item" id="context-cut">
            <i class="fas fa-cut"></i>
            <span>Вырезать</span>
        </div>
        <div class="context-menu-item" id="context-paste">
            <i class="fas fa-paste"></i>
            <span>Вставить</span>
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" id="context-rename">
            <i class="fas fa-edit"></i>
            <span>Переименовать</span>
        </div>
        <div class="context-menu-item" id="context-delete">
            <i class="fas fa-trash-alt"></i>
            <span>Удалить</span>
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" id="context-properties">
            <i class="fas fa-info-circle"></i>
            <span>Свойства</span>
        </div>
    </div>
    
    <!-- Тултип -->
    <div class="tooltip" id="tooltip"></div>
    
    <!-- Выпадающее меню -->
    <div class="dropdown" id="dropdown-menu"></div>

    <!-- ======================== JavaScript ======================== -->
    <script>
       // ============================================
// ОСНОВНЫЕ КОНСТАНТЫ И ПЕРЕМЕННЫЕ
// ============================================

// Расширенный список приложений для ПК
const APPS = [
    // Основные приложения (бесплатные, установлены по умолчанию)
    { 
        id: 'browser', 
        name: 'Браузер', 
        description: 'Веб-браузер с поддержкой вкладок, закладок и истории',
        icon: 'fas fa-globe', 
        category: 'internet',
        price: 0,
        installed: true,
        desktopIcon: true,
        pinned: true
    },
    { 
        id: 'text-editor', 
        name: 'Текстовый редактор', 
        description: 'Полнофункциональный редактор с форматированием и поддержкой различных форматов',
        icon: 'fas fa-file-alt', 
        category: 'productivity',
        price: 0,
        installed: true,
        desktopIcon: true,
        pinned: true
    },
    { 
        id: 'media-player', 
        name: 'Медиаплеер', 
        description: 'Воспроизведение видео, музыки и потоковых трансляций',
        icon: 'fas fa-play-circle', 
        category: 'media',
        price: 0,
        installed: true,
        desktopIcon: true,
        pinned: true
    },
    { 
        id: 'file-manager', 
        name: 'Файловый менеджер', 
        description: 'Управление файлами и папками на вашем устройстве',
        icon: 'fas fa-folder', 
        category: 'utils',
        price: 0,
        installed: true,
        desktopIcon: true,
        pinned: true
    },
    { 
        id: 'app-store', 
        name: 'Магазин приложений', 
        description: 'Установка и обновление приложений для AfagOS',
        icon: 'fas fa-shopping-cart', 
        category: 'utils',
        price: 0,
        installed: true,
        desktopIcon: true,
        pinned: true
    },
    { 
        id: 'settings', 
        name: 'Настройки системы', 
        description: 'Настройка параметров системы, персонализация и управление устройствами',
        icon: 'fas fa-cog', 
        category: 'utils',
        price: 0,
        installed: true,
        desktopIcon: true,
        pinned: true
    },
    { 
        id: 'calculator', 
        name: 'Калькулятор', 
        description: 'Научный калькулятор с дополнительными функциями',
        icon: 'fas fa-calculator', 
        category: 'utils',
        price: 0,
        installed: true,
        desktopIcon: true,
        pinned: false
    },
    { 
        id: 'paint', 
        name: 'Графический редактор', 
        description: 'Рисование и редактирование изображений',
        icon: 'fas fa-paint-brush', 
        category: 'media',
        price: 0,
        installed: true,
        desktopIcon: true,
        pinned: false
    },
    { 
        id: 'calendar', 
        name: 'Календарь', 
        description: 'Планировщик событий и напоминаний',
        icon: 'fas fa-calendar', 
        category: 'productivity',
        price: 0,
        installed: true,
        desktopIcon: false,
        pinned: false
    },
    { 
        id: 'notes', 
        name: 'Заметки', 
        description: 'Блокнот для быстрых записей и заметок',
        icon: 'fas fa-sticky-note', 
        category: 'productivity',
        price: 0,
        installed: true,
        desktopIcon: false,
        pinned: false
    },
    { 
        id: 'monitor', 
        name: 'Системный монитор', 
        description: 'Мониторинг использования ресурсов системы',
        icon: 'fas fa-chart-bar', 
        category: 'utils',
        price: 0,
        installed: true,
        desktopIcon: false,
        pinned: false
    },
    { 
        id: 'terminal', 
        name: 'Терминал', 
        description: 'Командная строка для продвинутых пользователей',
        icon: 'fas fa-terminal', 
        category: 'utils',
        price: 0,
        installed: true,
        desktopIcon: false,
        pinned: false
    },
    { 
        id: 'mail', 
        name: 'Почта', 
        description: 'Электронная почта и управление письмами',
        icon: 'fas fa-envelope', 
        category: 'internet',
        price: 0,
        installed: true,
        desktopIcon: false,
        pinned: false
    },
    { 
        id: 'cloud', 
        name: 'Облачное хранилище', 
        description: 'Хранение файлов в облаке и синхронизация',
        icon: 'fas fa-cloud', 
        category: 'utils',
        price: 0,
        installed: true,
        desktopIcon: false,
        pinned: false
    },
    { 
        id: 'weather', 
        name: 'Погода', 
        description: 'Прогноз погоды и метеорологические данные',
        icon: 'fas fa-cloud-sun', 
        category: 'utils',
        price: 0,
        installed: true,
        desktopIcon: false,
        pinned: false
    },
    { 
        id: 'tetris', 
        name: 'Тетрис', 
        description: 'Классическая игра для развлечения',
        icon: 'fas fa-gamepad', 
        category: 'games',
        price: 0,
        installed: true,
        desktopIcon: false,
        pinned: false
    },
    
    // Платные приложения для магазина
    { 
        id: 'photoshop', 
        name: 'Afag Photoshop', 
        description: 'Профессиональный графический редактор с расширенными функциями',
        icon: 'fas fa-palette', 
        category: 'media',
        price: 2999,
        installed: false,
        rating: 4.8,
        size: '2.4 ГБ'
    },
    { 
        id: 'office', 
        name: 'Afag Office', 
        description: 'Офисный пакет с текстовым редактором, таблицами и презентациями',
        icon: 'fas fa-file-word', 
        category: 'productivity',
        price: 1999,
        installed: false,
        rating: 4.6,
        size: '1.8 ГБ'
    },
    { 
        id: 'video-editor', 
        name: 'Видеоредактор Pro', 
        description: 'Профессиональное редактирование видео и создание фильмов',
        icon: 'fas fa-video', 
        category: 'media',
        price: 2499,
        installed: false,
        rating: 4.7,
        size: '3.2 ГБ'
    },
    { 
        id: 'antivirus', 
        name: 'Afag Antivirus', 
        description: 'Защита от вирусов и вредоносного ПО в реальном времени',
        icon: 'fas fa-shield-alt', 
        category: 'utils',
        price: 1499,
        installed: false,
        rating: 4.9,
        size: '450 МБ'
    },
    { 
        id: 'minecraft', 
        name: 'Minecraft', 
        description: 'Популярная игра с открытым миром и бесконечными возможностями',
        icon: 'fas fa-cube', 
        category: 'games',
        price: 999,
        installed: false,
        rating: 4.9,
        size: '1.2 ГБ'
    },
    { 
        id: 'photos', 
        name: 'Менеджер фотографий', 
        description: 'Управление, редактирование и организация фотографий',
        icon: 'fas fa-images', 
        category: 'media',
        price: 799,
        installed: false,
        rating: 4.4,
        size: '850 МБ'
    },
    { 
        id: 'music-studio', 
        name: 'Музыкальная студия', 
        description: 'Запись, редактирование и создание музыки',
        icon: 'fas fa-music', 
        category: 'media',
        price: 1799,
        installed: false,
        rating: 4.5,
        size: '1.5 ГБ'
    },
    { 
        id: 'code-editor', 
        name: 'Редактор кода', 
        description: 'IDE для программирования с поддержкой множества языков',
        icon: 'fas fa-code', 
        category: 'productivity',
        price: 0,
        installed: false,
        rating: 4.7,
        size: '950 МБ'
    },
    { 
        id: 'vpn', 
        name: 'Afag VPN', 
        description: 'Защищенное подключение к интернету и обход блокировок',
        icon: 'fas fa-user-secret', 
        category: 'internet',
        price: 499,
        installed: false,
        rating: 4.3,
        size: '120 МБ'
    },
    { 
        id: 'language-learning', 
        name: 'Изучение языков', 
        description: 'Интерактивные курсы для изучения иностранных языков',
        icon: 'fas fa-language', 
        category: 'education',
        price: 1299,
        installed: false,
        rating: 4.6,
        size: '2.1 ГБ'
    }
];

// Данные пользователя
let currentUser = {
    username: 'Администратор',
    role: 'Владелец системы',
    avatarIcon: 'fas fa-user',
    password: 'admin123',
    balance: 1000,
    theme: 'dark',
    wallpaper: 'default'
};

// Системные настройки
let systemSettings = {
    notifications: true,
    sound: true,
    autostart: [],
    powerMode: 'balanced',
    language: 'ru'
};

// Состояние системы
let systemState = {
    booted: false,
    setupCompleted: localStorage.getItem('afagos_setup_completed') === 'true',
    locked: false,
    currentScreen: 'boot',
    activeWindows: [],
    taskbarApps: [],
    notifications: [],
    desktopIcons: [],
    startMenuOpen: false,
    notificationCenterOpen: false
};

// ============================================
// ИНИЦИАЛИЗАЦИЯ СИСТЕМЫ
// ============================================

document.addEventListener('DOMContentLoaded', function() {
    // Инициализация системы
    initSystem();
    
    // Инициализация часов
    initClock();
    
    // Загрузка данных пользователя
    loadUserData();
    
    // Настройка обработчиков событий
    setupEventListeners();
    
    // Начало загрузки системы
    startBootSequence();
});

function initSystem() {
    console.log('Инициализация AfagOS...');
    
    // Скрыть все окна приложений при загрузке
    document.querySelectorAll('.app-window').forEach(window => {
        window.style.display = 'none';
    });
    
    // Показать экран загрузки
    document.getElementById('boot-screen').style.display = 'flex';
    systemState.currentScreen = 'boot';
}

function startBootSequence() {
    const bootMessages = [
        "Инициализация системы...",
        "Загрузка ядра...",
        "Инициализация драйверов...",
        "Загрузка системных служб...",
        "Подготовка рабочего стола...",
        "Запуск оболочки...",
        "Готово!"
    ];
    
    let currentStep = 0;
    const totalSteps = bootMessages.length;
    const bootProgressBar = document.getElementById('boot-progress-bar');
    const bootMessage = document.getElementById('boot-message');
    const bootProgress = document.getElementById('boot-progress');
    
    function updateBootProgress() {
        if (currentStep < totalSteps) {
            const progress = ((currentStep + 1) / totalSteps) * 100;
            bootProgressBar.style.width = `${progress}%`;
            bootMessage.textContent = bootMessages[currentStep];
            bootProgress.textContent = `${Math.round(progress)}%`;
            
            // Имитация разной длительности шагов
            let delay = 300 + Math.random() * 700;
            
            // Последний шаг делаем быстрее
            if (currentStep === totalSteps - 1) {
                delay = 100;
            }
            
            currentStep++;
            setTimeout(updateBootProgress, delay);
        } else {
            // Загрузка завершена
            setTimeout(() => {
                document.getElementById('boot-screen').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('boot-screen').style.display = 'none';
                    
                    // Проверка, выполнена ли первоначальная настройка
                    if (!systemState.setupCompleted) {
                        showSetupScreen();
                    } else {
                        showLockScreen();
                    }
                }, 800);
            }, 500);
        }
    }
    
    updateBootProgress();
}

function showSetupScreen() {
    document.getElementById('setup-screen').style.display = 'flex';
    systemState.currentScreen = 'setup';
    initSetupWizard();
}

function showLockScreen() {
    document.getElementById('lock-screen').style.display = 'flex';
    systemState.currentScreen = 'lock';
    updateLockScreenTime();
}

function showDesktop() {
    document.getElementById('desktop').style.display = 'flex';
    systemState.currentScreen = 'desktop';
    
    // Инициализация рабочего стола
    initDesktop();
    
    // Обновление времени на панели задач
    updateDesktopTime();
    
    // Создание уведомления о загрузке
    addNotification('Система AfagOS', 'Операционная система успешно загружена!', 'success');
}

function initDesktop() {
    // Создание иконок на рабочем столе
    createDesktopIcons();
    
    // Добавление приложений в панель задач
    updateTaskbar();
    
    // Инициализация меню "Пуск"
    initStartMenu();
}

function createDesktopIcons() {
    const desktopIconsContainer = document.getElementById('desktop-icons');
    desktopIconsContainer.innerHTML = '';
    
    APPS.filter(app => app.desktopIcon && app.installed).forEach(app => {
        const icon = document.createElement('div');
        icon.className = 'desktop-icon';
        icon.dataset.app = app.id;
        icon.innerHTML = `
            <i class="${app.icon}"></i>
            <div class="desktop-icon-text">${app.name}</div>
        `;
        
        icon.addEventListener('click', () => openApp(app.id));
        icon.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            showContextMenu(e, app);
        });
        
        desktopIconsContainer.appendChild(icon);
    });
}

function openApp(appId) {
    const appWindow = document.getElementById(`${appId}-window`);
    
    if (appWindow) {
        // Показать окно приложения
        appWindow.style.display = 'flex';
        appWindow.style.zIndex = 500 + systemState.activeWindows.length;
        
        // Добавить в активные окна
        if (!systemState.activeWindows.includes(appId)) {
            systemState.activeWindows.push(appId);
        }
        
        // Обновить панель задач
        updateTaskbar();
        
        // Добавить приложение в панель задач
        addAppToTaskbar(appId);
        
        // Закрыть меню "Пуск", если оно открыто
        if (systemState.startMenuOpen) {
            toggleStartMenu();
        }
    }
}

function closeApp(appId) {
    const appWindow = document.getElementById(`${appId}-window`);
    
    if (appWindow) {
        // Скрыть окно приложения
        appWindow.style.display = 'none';
        
        // Удалить из активных окон
        const index = systemState.activeWindows.indexOf(appId);
        if (index > -1) {
            systemState.activeWindows.splice(index, 1);
        }
        
        // Обновить панель задач
        updateTaskbar();
    }
}

function addAppToTaskbar(appId) {
    const app = APPS.find(a => a.id === appId);
    if (!app || systemState.taskbarApps.includes(appId)) return;
    
    systemState.taskbarApps.push(appId);
    updateTaskbar();
}

function updateTaskbar() {
    const taskbarAppsContainer = document.getElementById('taskbar-apps');
    taskbarAppsContainer.innerHTML = '';
    
    systemState.taskbarApps.forEach(appId => {
        const app = APPS.find(a => a.id === appId);
        if (!app) return;
        
        const isActive = systemState.activeWindows.includes(appId);
        
        const taskbarApp = document.createElement('div');
        taskbarApp.className = `taskbar-app ${isActive ? 'active' : ''}`;
        taskbarApp.dataset.app = appId;
        taskbarApp.innerHTML = `
            <i class="${app.icon}"></i>
            <span>${app.name}</span>
        `;
        
        taskbarApp.addEventListener('click', () => {
            const appWindow = document.getElementById(`${appId}-window`);
            if (appWindow.style.display === 'flex') {
                // Если окно уже открыто, скрыть его
                appWindow.style.display = 'none';
                const index = systemState.activeWindows.indexOf(appId);
                if (index > -1) {
                    systemState.activeWindows.splice(index, 1);
                }
            } else {
                // Если окно закрыто, открыть его
                openApp(appId);
            }
            updateTaskbar();
        });
        
        taskbarAppsContainer.appendChild(taskbarApp);
    });
}

function initStartMenu() {
    const startItems = document.querySelectorAll('.start-item');
    startItems.forEach(item => {
        item.addEventListener('click', function() {
            // Удалить активный класс у всех элементов
            startItems.forEach(i => i.classList.remove('active'));
            // Добавить активный класс текущему элементу
            this.classList.add('active');
            
            // Загрузить соответствующий раздел
            const section = this.dataset.section;
            loadStartMenuSection(section);
        });
    });
    
    // Загрузить раздел по умолчанию
    loadStartMenuSection('pinned');
}

function loadStartMenuSection(section) {
    const startMain = document.getElementById('start-main');
    
    switch(section) {
        case 'pinned':
            startMain.innerHTML = `
                <div class="pinned-apps">
                    ${APPS.filter(app => app.pinned && app.installed).map(app => `
                        <div class="pinned-app" data-app="${app.id}">
                            <i class="${app.icon}"></i>
                            <div class="pinned-app-name">${app.name}</div>
                        </div>
                    `).join('')}
                </div>
            `;
            break;
            
        case 'recent':
            startMain.innerHTML = `
                <div style="padding: 1rem;">
                    <div class="section-title">Недавние приложения</div>
                    <div class="recent-apps">
                        ${APPS.filter(app => app.installed).slice(0, 6).map(app => `
                            <div class="recent-app" data-app="${app.id}">
                                <div class="recent-app-icon">
                                    <i class="${app.icon}"></i>
                                </div>
                                <div class="recent-app-info">
                                    <div class="recent-app-name">${app.name}</div>
                                    <div class="recent-app-time">Только что</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            break;
            
        case 'apps':
            startMain.innerHTML = `
                <div style="padding: 1rem;">
                    <div class="section-title">Все приложения</div>
                    <div class="app-grid" style="grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));">
                        ${APPS.filter(app => app.installed).map(app => `
                            <div class="app-card" style="height: auto;" data-app="${app.id}">
                                <div class="app-icon" style="height: 80px;">
                                    <i class="${app.icon}"></i>
                                </div>
                                <div class="app-info" style="padding: 1rem;">
                                    <div class="app-name" style="font-size: 1rem;">${app.name}</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            break;
            
        case 'games':
            startMain.innerHTML = `
                <div style="padding: 1rem;">
                    <div class="section-title">Игры</div>
                    <div class="game-card" data-app="tetris">
                        <div class="game-cover" style="height: 120px;">
                            <div class="game-play">
                                <i class="fas fa-play"></i>
                            </div>
                        </div>
                        <div class="game-info">
                            <div class="game-title">Тетрис</div>
                            <div class="game-desc">Классическая игра для развлечения</div>
                            <div class="game-meta">
                                <div class="game-rating">
                                    <i class="fas fa-star"></i>
                                    <span>4.5</span>
                                </div>
                                <div class="game-size">1.2 ГБ</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            break;
            
        case 'utils':
            startMain.innerHTML = `
                <div style="padding: 1rem;">
                    <div class="section-title">Утилиты</div>
                    <div class="system-utilities">
                        ${APPS.filter(app => app.category === 'utils' && app.installed).map(app => `
                            <div class="utility-card" data-app="${app.id}">
                                <div class="utility-icon">
                                    <i class="${app.icon}"></i>
                                </div>
                                <div class="utility-name">${app.name}</div>
                                <div class="utility-desc">${app.description.substring(0, 60)}...</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            break;
            
        case 'settings':
            startMain.innerHTML = `
                <div style="padding: 1rem; text-align: center;">
                    <div style="font-size: 3rem; color: #3b82f6; margin-bottom: 1rem;">
                        <i class="fas fa-cog"></i>
                    </div>
                    <div style="font-size: 1.5rem; font-weight: 700; color: #f1f5f9; margin-bottom: 1rem;">
                        Настройки системы
                    </div>
                    <div style="color: #94a3b8; margin-bottom: 2rem;">
                        Настройте параметры вашей операционной системы
                    </div>
                    <button class="install-button" data-app="settings">
                        <i class="fas fa-external-link-alt"></i>
                        <span>Открыть настройки</span>
                    </button>
                </div>
            `;
            break;
            
        case 'power':
            startMain.innerHTML = `
                <div style="padding: 1rem; text-align: center;">
                    <div style="font-size: 3rem; color: #ef4444; margin-bottom: 1rem;">
                        <i class="fas fa-power-off"></i>
                    </div>
                    <div style="font-size: 1.5rem; font-weight: 700; color: #f1f5f9; margin-bottom: 1rem;">
                        Питание
                    </div>
                    <div style="color: #94a3b8; margin-bottom: 2rem;">
                        Управление питанием системы
                    </div>
                    <div style="display: flex; flex-direction: column; gap: 1rem;">
                        <button class="install-button" id="start-shutdown" style="background: #ef4444;">
                            <i class="fas fa-power-off"></i>
                            <span>Выключить</span>
                        </button>
                        <button class="install-button" id="start-restart" style="background: #3b82f6;">
                            <i class="fas fa-redo"></i>
                            <span>Перезагрузить</span>
                        </button>
                        <button class="install-button" id="start-sleep" style="background: #8b5cf6;">
                            <i class="fas fa-moon"></i>
                            <span>Спящий режим</span>
                        </button>
                    </div>
                </div>
            `;
            break;
    }
    
    // Добавить обработчики событий для приложений в меню "Пуск"
    startMain.querySelectorAll('[data-app]').forEach(element => {
        element.addEventListener('click', function() {
            const appId = this.dataset.app;
            openApp(appId);
            toggleStartMenu();
        });
    });
}

function initSetupWizard() {
    const setupSteps = [
        {
            title: 'Добро пожаловать',
            icon: 'fas fa-hand-wave',
            content: `
                <div class="setup-finish-container">
                    <div class="setup-finish-icon">
                        <i class="fas fa-rocket"></i>
                    </div>
                    <div class="setup-finish-title">Добро пожаловать в AfagOS</div>
                    <div class="setup-finish-text">
                        Спасибо, что выбрали нашу операционную систему. Давайте настроим её для вас.
                        Процесс займет всего несколько минут.
                    </div>
                </div>
            `
        },
        {
            title: 'Настройка пользователя',
            icon: 'fas fa-user',
            content: `
                <div class="setup-step">
                    <div class="step-title">
                        <i class="fas fa-user"></i>
                        <span>Создание пользователя</span>
                    </div>
                    <div class="setup-input-group">
                        <label class="setup-label">
                            <i class="fas fa-user-circle"></i>
                            <span>Имя пользователя</span>
                        </label>
                        <input type="text" class="setup-input" id="setup-username" 
                               placeholder="Введите ваше имя" value="${currentUser.username}">
                    </div>
                    <div class="setup-input-group">
                        <label class="setup-label">
                            <i class="fas fa-key"></i>
                            <span>Пароль</span>
                        </label>
                        <input type="password" class="setup-input" id="setup-password" 
                               placeholder="Введите пароль" value="${currentUser.password}">
                    </div>
                    <div class="setup-input-group">
                        <label class="setup-label">
                            <i class="fas fa-key"></i>
                            <span>Подтвердите пароль</span>
                        </label>
                        <input type="password" class="setup-input" id="setup-password-confirm" 
                               placeholder="Повторите пароль" value="${currentUser.password}">
                    </div>
                </div>
            `
        },
        {
            title: 'Выбор приложений',
            icon: 'fas fa-th-large',
            content: `
                <div class="setup-step">
                    <div class="step-title">
                        <i class="fas fa-th-large"></i>
                        <span>Установка приложений</span>
                    </div>
                    <div class="setup-checkbox-container">
                        ${APPS.filter(app => app.price === 0 && !app.installed).map(app => `
                            <div class="setup-checkbox">
                                <input type="checkbox" id="setup-app-${app.id}" checked>
                                <div class="setup-app-icon">
                                    <i class="${app.icon}"></i>
                                </div>
                                <label for="setup-app-${app.id}">${app.name}</label>
                                <div class="app-price">Бесплатно</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `
        },
        {
            title: 'Персонализация',
            icon: 'fas fa-palette',
            content: `
                <div class="setup-step">
                    <div class="step-title">
                        <i class="fas fa-palette"></i>
                        <span>Настройка внешнего вида</span>
                    </div>
                    <div class="setup-input-group">
                        <label class="setup-label">
                            <i class="fas fa-moon"></i>
                            <span>Тема оформления</span>
                        </label>
                        <select class="setup-select" id="setup-theme">
                            <option value="dark" selected>Темная</option>
                            <option value="light">Светлая</option>
                            <option value="blue">Синяя</option>
                            <option value="purple">Фиолетовая</option>
                        </select>
                    </div>
                    <div class="setup-input-group">
                        <label class="setup-label">
                            <i class="fas fa-image"></i>
                            <span>Обои рабочего стола</span>
                        </label>
                        <select class="setup-select" id="setup-wallpaper">
                            <option value="default" selected>По умолчанию</option>
                            <option value="gradient">Градиент</option>
                            <option value="space">Космос</option>
                            <option value="nature">Природа</option>
                        </select>
                    </div>
                </div>
            `
        },
        {
            title: 'Завершение',
            icon: 'fas fa-check-circle',
            content: `
                <div class="setup-finish-container">
                    <div class="setup-finish-icon">
                        <i class="fas fa-check"></i>
                    </div>
                    <div class="setup-finish-title">Настройка завершена!</div>
                    <div class="setup-finish-text">
                        Ваша операционная система AfagOS настроена и готова к использованию.
                        Нажмите "Завершить", чтобы начать работу.
                    </div>
                </div>
            `
        }
    ];
    
    const setupStepsContainer = document.getElementById('setup-steps');
    const setupNextButton = document.getElementById('setup-next');
    const setupBackButton = document.getElementById('setup-back');
    const setupStepText = document.getElementById('setup-step-text');
    const setupStepPercent = document.getElementById('setup-step-percent');
    const setupProgressBar = document.getElementById('setup-progress-bar');
    
    let currentStep = 0;
    
    function showStep(stepIndex) {
        setupStepsContainer.innerHTML = setupSteps[stepIndex].content;
        
        // Обновить прогресс
        const progress = ((stepIndex + 1) / setupSteps.length) * 100;
        setupStepText.textContent = `Шаг ${stepIndex + 1} из ${setupSteps.length}`;
        setupStepPercent.textContent = `${Math.round(progress)}%`;
        setupProgressBar.style.width = `${progress}%`;
        
        // Обновить кнопки
        setupBackButton.style.display = stepIndex === 0 ? 'none' : 'flex';
        
        if (stepIndex === setupSteps.length - 1) {
            setupNextButton.innerHTML = `
                <span>Завершить</span>
                <i class="fas fa-check"></i>
            `;
        } else {
            setupNextButton.innerHTML = `
                <span>Далее</span>
                <i class="fas fa-arrow-right"></i>
            `;
        }
    }
    
    setupNextButton.addEventListener('click', function() {
        if (currentStep === setupSteps.length - 1) {
            // Завершение настройки
            completeSetup();
        } else {
            currentStep++;
            showStep(currentStep);
        }
    });
    
    setupBackButton.addEventListener('click', function() {
        if (currentStep > 0) {
            currentStep--;
            showStep(currentStep);
        }
    });
    
    // Показать первый шаг
    showStep(0);
}

function completeSetup() {
    // Сохранение данных пользователя
    const username = document.getElementById('setup-username')?.value || currentUser.username;
    const password = document.getElementById('setup-password')?.value || currentUser.password;
    const theme = document.getElementById('setup-theme')?.value || currentUser.theme;
    const wallpaper = document.getElementById('setup-wallpaper')?.value || currentUser.wallpaper;
    
    // Обновление данных пользователя
    currentUser = {
        ...currentUser,
        username,
        password,
        theme,
        wallpaper
    };
    
    // Сохранение в localStorage
    localStorage.setItem('afagos_user', JSON.stringify(currentUser));
    localStorage.setItem('afagos_setup_completed', 'true');
    
    // Обновление интерфейса
    updateUserInterface();
    
    // Скрыть экран настройки
    document.getElementById('setup-screen').style.display = 'none';
    
    // Показать рабочий стол
    showDesktop();
    
    // Добавить уведомление
    addNotification('Настройка завершена', `Добро пожаловать, ${username}!`, 'success');
}

function loadUserData() {
    const savedUser = localStorage.getItem('afagos_user');
    if (savedUser) {
        try {
            const parsedUser = JSON.parse(savedUser);
            currentUser = { ...currentUser, ...parsedUser };
        } catch (e) {
            console.error('Ошибка загрузки данных пользователя:', e);
        }
    }
}

function updateUserInterface() {
    // Обновление имени пользователя
    document.querySelectorAll('#lock-username, #start-username').forEach(element => {
        element.textContent = currentUser.username;
    });
    
    // Обновление иконки пользователя
    document.querySelectorAll('#lock-avatar-icon, #start-avatar-icon').forEach(element => {
        element.className = currentUser.avatarIcon;
    });
    
    // Обновление роли
    document.getElementById('start-user-role').textContent = currentUser.role;
    
    // Обновление баланса
    document.getElementById('store-balance').textContent = `${currentUser.balance} ₽`;
}

function initClock() {
    updateClock();
    setInterval(updateClock, 1000);
}

function updateClock() {
    const now = new Date();
    
    // Форматирование времени
    const hours = now.getHours().toString().padStart(2, '0');
    const minutes = now.getMinutes().toString().padStart(2, '0');
    const timeString = `${hours}:${minutes}`;
    
    // Форматирование даты
    const days = ['Воскресенье', 'Понедельник', 'Вторник', 'Среда', 'Четверг', 'Пятница', 'Суббота'];
    const months = ['января', 'февраля', 'марта', 'апреля', 'мая', 'июня', 'июля', 'августа', 'сентября', 'октября', 'ноября', 'декабря'];
    
    const dayOfWeek = days[now.getDay()];
    const day = now.getDate();
    const month = months[now.getMonth()];
    const year = now.getFullYear();
    const dateString = `${dayOfWeek}, ${day} ${month} ${year}`;
    
    // Форматирование короткой даты
    const shortDate = `${day.toString().padStart(2, '0')}.${(now.getMonth() + 1).toString().padStart(2, '0')}.${year}`;
    
    // Обновление времени на экране блокировки
    const lockTime = document.getElementById('lock-time');
    const lockDate = document.getElementById('lock-date');
    
    if (lockTime) lockTime.textContent = timeString;
    if (lockDate) lockDate.textContent = dateString;
    
    // Обновление времени на рабочем столе
    updateDesktopTime();
}

function updateDesktopTime() {
    const now = new Date();
    const hours = now.getHours().toString().padStart(2, '0');
    const minutes = now.getMinutes().toString().padStart(2, '0');
    const timeString = `${hours}:${minutes}`;
    
    const day = now.getDate().toString().padStart(2, '0');
    const month = (now.getMonth() + 1).toString().padStart(2, '0');
    const year = now.getFullYear();
    const dateString = `${day}.${month}.${year}`;
    
    const desktopTime = document.getElementById('desktop-time');
    const desktopDate = document.getElementById('desktop-date');
    
    if (desktopTime) desktopTime.textContent = timeString;
    if (desktopDate) desktopDate.textContent = dateString;
}

function updateLockScreenTime() {
    // Функция уже вызывается в updateClock()
}

function addNotification(title, message, type = 'info') {
    const notification = {
        id: Date.now(),
        title,
        message,
        type,
        time: new Date(),
        read: false
    };
    
    systemState.notifications.unshift(notification);
    
    // Обновить счетчик уведомлений
    updateNotificationCount();
    
    // Показать уведомление, если центр уведомлений открыт
    if (systemState.notificationCenterOpen) {
        updateNotificationList();
    }
    
    // Показать всплывающее уведомление
    showToastNotification(notification);
}

function updateNotificationCount() {
    const unreadCount = systemState.notifications.filter(n => !n.read).length;
    
    // Обновить счетчик на панели задач
    const notificationCount = document.getElementById('notification-count');
    if (notificationCount) {
        notificationCount.textContent = unreadCount;
        notificationCount.style.display = unreadCount > 0 ? 'inline' : 'none';
    }
    
    // Обновить счетчик в центре уведомлений
    const notificationCountBadge = document.getElementById('notification-count-badge');
    if (notificationCountBadge) {
        notificationCountBadge.textContent = `${unreadCount} новых`;
    }
}

function updateNotificationList() {
    const notificationList = document.getElementById('notification-list');
    if (!notificationList) return;
    
    notificationList.innerHTML = systemState.notifications.map(notification => `
        <div class="notification-item ${notification.type} ${notification.read ? '' : 'unread'}" 
             data-id="${notification.id}">
            <div class="notification-title">
                <span>${notification.title}</span>
                <span class="notification-time">${formatNotificationTime(notification.time)}</span>
            </div>
            <div class="notification-message">${notification.message}</div>
        </div>
    `).join('');
}

function formatNotificationTime(time) {
    const now = new Date();
    const notificationTime = new Date(time);
    const diffMs = now - notificationTime;
    const diffMins = Math.floor(diffMs / 60000);
    const diffHours = Math.floor(diffMs / 3600000);
    
    if (diffMins < 1) {
        return 'Только что';
    } else if (diffMins < 60) {
        return `${diffMins} мин назад`;
    } else if (diffHours < 24) {
        return `${diffHours} ч назад`;
    } else {
        return notificationTime.toLocaleDateString('ru-RU');
    }
}

function showToastNotification(notification) {
    // Создание элемента уведомления
    const toast = document.createElement('div');
    toast.className = `notification-toast ${notification.type}`;
    toast.innerHTML = `
        <div class="toast-icon">
            <i class="fas fa-${notification.type === 'success' ? 'check-circle' : 
                               notification.type === 'error' ? 'exclamation-circle' : 
                               'info-circle'}"></i>
        </div>
        <div class="toast-content">
            <div class="toast-title">${notification.title}</div>
            <div class="toast-message">${notification.message}</div>
        </div>
        <button class="toast-close">
            <i class="fas fa-times"></i>
        </button>
    `;
    
    // Стили для тоста
    toast.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: rgba(30, 41, 59, 0.95);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(100, 116, 139, 0.4);
        border-radius: 12px;
        padding: 1rem 1.5rem;
        display: flex;
        align-items: center;
        gap: 1rem;
        min-width: 300px;
        max-width: 400px;
        z-index: 10000;
        animation: slideInRight 0.3s ease-out;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    `;
    
    // Добавление в DOM
    document.body.appendChild(toast);
    
    // Автоматическое скрытие через 5 секунд
    setTimeout(() => {
        toast.style.animation = 'fadeOut 0.3s ease-out';
        setTimeout(() => {
            if (toast.parentNode) {
                toast.parentNode.removeChild(toast);
            }
        }, 300);
    }, 5000);
    
    // Закрытие по клику
    toast.querySelector('.toast-close').addEventListener('click', () => {
        toast.style.animation = 'fadeOut 0.3s ease-out';
        setTimeout(() => {
            if (toast.parentNode) {
                toast.parentNode.removeChild(toast);
            }
        }, 300);
    });
}

function toggleStartMenu() {
    const startMenu = document.getElementById('start-menu');
    if (startMenu.style.display === 'flex') {
        startMenu.style.display = 'none';
        systemState.startMenuOpen = false;
    } else {
        startMenu.style.display = 'flex';
        systemState.startMenuOpen = true;
        
        // Закрыть центр уведомлений, если он открыт
        if (systemState.notificationCenterOpen) {
            toggleNotificationCenter();
        }
    }
}

function toggleNotificationCenter() {
    const notificationCenter = document.getElementById('notification-center');
    if (notificationCenter.style.display === 'flex') {
        notificationCenter.style.display = 'none';
        systemState.notificationCenterOpen = false;
    } else {
        notificationCenter.style.display = 'flex';
        systemState.notificationCenterOpen = true;
        updateNotificationList();
        
        // Закрыть меню "Пуск", если оно открыто
        if (systemState.startMenuOpen) {
            toggleStartMenu();
        }
    }
}

function showContextMenu(e, app) {
    e.preventDefault();
    
    const contextMenu = document.getElementById('context-menu');
    contextMenu.style.display = 'block';
    contextMenu.style.left = `${e.clientX}px`;
    contextMenu.style.top = `${e.clientY}px`;
    
    // Обработчики для пунктов контекстного меню
    document.getElementById('context-open').onclick = () => {
        openApp(app.id);
        contextMenu.style.display = 'none';
    };
    
    document.getElementById('context-run').onclick = () => {
        openApp(app.id);
        contextMenu.style.display = 'none';
    };
    
    document.getElementById('context-delete').onclick = () => {
        showAlertModal('Удаление', `Вы уверены, что хотите удалить "${app.name}"?`);
        contextMenu.style.display = 'none';
    };
    
    document.getElementById('context-properties').onclick = () => {
        showPropertiesModal(app);
        contextMenu.style.display = 'none';
    };
    
    // Закрытие контекстного меню при клике вне его
    setTimeout(() => {
        document.addEventListener('click', function closeContextMenu() {
            contextMenu.style.display = 'none';
            document.removeEventListener('click', closeContextMenu);
        });
    }, 10);
}

function showAlertModal(title, message) {
    const modal = document.getElementById('alert-modal');
    const modalTitle = document.getElementById('alert-title');
    const modalText = document.getElementById('alert-text');
    const modalClose = document.getElementById('alert-close');
    const modalOk = document.getElementById('alert-ok');
    
    modalTitle.textContent = title;
    modalText.textContent = message;
    modal.style.display = 'flex';
    
    modalClose.onclick = () => {
        modal.style.display = 'none';
    };
    
    modalOk.onclick = () => {
        modal.style.display = 'none';
    };
}

function showPropertiesModal(app) {
    const modal = document.createElement('div');
    modal.className = 'modal';
    modal.style.display = 'flex';
    modal.innerHTML = `
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Свойства: ${app.name}</div>
                <button class="modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-text">
                <div style="display: flex; gap: 2rem; margin-bottom: 2rem;">
                    <div style="font-size: 4rem; color: #3b82f6;">
                        <i class="${app.icon}"></i>
                    </div>
                    <div>
                        <div style="font-size: 1.5rem; font-weight: 700; color: #f1f5f9; margin-bottom: 0.5rem;">
                            ${app.name}
                        </div>
                        <div style="color: #94a3b8;">${app.description}</div>
                    </div>
                </div>
                <div style="background: #0f172a; border-radius: 12px; padding: 1.5rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 1rem;">
                        <span style="color: #94a3b8;">Категория:</span>
                        <span style="color: #f1f5f9;">${getCategoryName(app.category)}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 1rem;">
                        <span style="color: #94a3b8;">Статус:</span>
                        <span style="color: #10b981;">${app.installed ? 'Установлено' : 'Не установлено'}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: #94a3b8;">Цена:</span>
                        <span style="color: #f1f5f9; font-weight: 700;">${app.price === 0 ? 'Бесплатно' : app.price + ' ₽'}</span>
                    </div>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="modal-button confirm" id="modal-close-btn">Закрыть</button>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    
    modal.querySelector('.modal-close').onclick = () => {
        modal.remove();
    };
    
    modal.querySelector('#modal-close-btn').onclick = () => {
        modal.remove();
    };
}

function getCategoryName(category) {
    const categories = {
        'internet': 'Интернет',
        'productivity': 'Производительность',
        'media': 'Медиа',
        'utils': 'Утилиты',
        'games': 'Игры',
        'education': 'Образование'
    };
    
    return categories[category] || category;
}

function setupEventListeners() {
    // Кнопка "Пуск"
    document.getElementById('start-button').addEventListener('click', toggleStartMenu);
    
    // Закрытие меню "Пуск" при клике вне его
    document.addEventListener('click', function(e) {
        const startMenu = document.getElementById('start-menu');
        const startButton = document.getElementById('start-button');
        
        if (systemState.startMenuOpen && 
            !startMenu.contains(e.target) && 
            !startButton.contains(e.target)) {
            toggleStartMenu();
        }
    });
    
    // Центр уведомлений
    document.getElementById('widget-notifications').addEventListener('click', toggleNotificationCenter);
    
    // Закрытие центра уведомлений при клике вне его
    document.addEventListener('click', function(e) {
        const notificationCenter = document.getElementById('notification-center');
        const notificationWidget = document.getElementById('widget-notifications');
        
        if (systemState.notificationCenterOpen && 
            !notificationCenter.contains(e.target) && 
            !notificationWidget.contains(e.target)) {
            toggleNotificationCenter();
        }
    });
    
    // Очистка уведомлений
    document.getElementById('clear-notifications').addEventListener('click', function() {
        systemState.notifications = [];
        updateNotificationCount();
        updateNotificationList();
    });
    
    // Разблокировка системы
    document.getElementById('lock-button').addEventListener('click', unlockSystem);
    document.getElementById('lock-input').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            unlockSystem();
        }
    });
    
    // Управление питанием на экране блокировки
    document.getElementById('lock-shutdown').addEventListener('click', showShutdownModal);
    document.getElementById('lock-restart').addEventListener('click', () => showShutdownModal('restart'));
    document.getElementById('lock-sleep').addEventListener('click', () => showShutdownModal('sleep'));
    
    // Управление питанием в меню "Пуск"
    document.getElementById('start-power').addEventListener('click', showShutdownModal);
    
    // Обновление времени на панели задач (при клике)
    document.getElementById('time-display').addEventListener('click', function() {
        addNotification('Время системы', `Текущее время: ${new Date().toLocaleTimeString('ru-RU')}`, 'info');
    });
    
    // Управление окнами приложений
    document.querySelectorAll('.window-control').forEach(control => {
        control.addEventListener('click', function() {
            const windowId = this.dataset.window;
            const action = this.classList.contains('minimize') ? 'minimize' :
                         this.classList.contains('maximize') ? 'maximize' : 'close';
            
            handleWindowControl(windowId, action);
        });
    });
    
    // Перетаскивание окон
    initWindowDrag();
    
    // Рабочий стол - клик для скрытия контекстного меню
    document.getElementById('desktop-area').addEventListener('click', function(e) {
        if (e.target === this) {
            document.getElementById('desktop-context-menu').style.display = 'none';
        }
    });
    
    // Контекстное меню рабочего стола
    document.getElementById('context-refresh').addEventListener('click', function() {
        addNotification('Рабочий стол', 'Рабочий стол обновлен', 'success');
        document.getElementById('desktop-context-menu').style.display = 'none';
    });
    
    document.getElementById('context-settings').addEventListener('click', function() {
        openApp('settings');
        document.getElementById('desktop-context-menu').style.display = 'none';
    });
    
    // Поиск в меню "Пуск"
    document.getElementById('start-search-button').addEventListener('click', performSearch);
    document.getElementById('start-search').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            performSearch();
        }
    });
}

function unlockSystem() {
    const passwordInput = document.getElementById('lock-input');
    const password = passwordInput.value;
    const errorElement = document.getElementById('lock-error');
    
    if (password === currentUser.password) {
        // Скрыть экран блокировки
        document.getElementById('lock-screen').style.display = 'none';
        
        // Показать рабочий стол
        showDesktop();
        
        // Очистить поле ввода
        passwordInput.value = '';
        
        // Скрыть сообщение об ошибке
        errorElement.style.display = 'none';
        
        // Добавить уведомление
        addNotification('Система разблокирована', `Добро пожаловать, ${currentUser.username}!`, 'success');
    } else {
        // Показать сообщение об ошибке
        errorElement.style.display = 'flex';
        document.getElementById('lock-error-text').textContent = 'Неверный пароль';
        
        // Анимация встряски
        passwordInput.classList.add('shake');
        setTimeout(() => {
            passwordInput.classList.remove('shake');
        }, 500);
    }
}

function handleWindowControl(windowId, action) {
    const windowElement = document.getElementById(`${windowId}-window`);
    
    if (!windowElement) return;
    
    switch(action) {
        case 'minimize':
            windowElement.style.display = 'none';
            
            // Удалить из активных окон
            const index = systemState.activeWindows.indexOf(windowId);
            if (index > -1) {
                systemState.activeWindows.splice(index, 1);
            }
            
            updateTaskbar();
            break;
            
        case 'maximize':
            if (windowElement.style.width === '100vw' && windowElement.style.height === '100vh') {
                // Восстановить размер
                windowElement.style.width = '';
                windowElement.style.height = '';
                windowElement.style.left = '';
                windowElement.style.top = '';
                windowElement.style.borderRadius = '20px';
            } else {
                // Развернуть на весь экран
                windowElement.style.width = '100vw';
                windowElement.style.height = '100vh';
                windowElement.style.left = '0';
                windowElement.style.top = '0';
                windowElement.style.borderRadius = '0';
            }
            break;
            
        case 'close':
            closeApp(windowId);
            break;
    }
}

function initWindowDrag() {
    const windows = document.querySelectorAll('.app-window');
    
    windows.forEach(window => {
        const header = window.querySelector('.window-header');
        
        let isDragging = false;
        let dragOffsetX, dragOffsetY;
        
        header.addEventListener('mousedown', startDrag);
        
        function startDrag(e) {
            if (e.target.closest('.window-control')) {
                return; // Не начинать перетаскивание при клике на кнопки управления
            }
            
            isDragging = true;
            
            // Вычислить смещение курсора относительно верхнего левого угла окна
            const rect = window.getBoundingClientRect();
            dragOffsetX = e.clientX - rect.left;
            dragOffsetY = e.clientY - rect.top;
            
            // Установить окно поверх других
            const maxZIndex = Math.max(...Array.from(document.querySelectorAll('.app-window'))
                .map(w => parseInt(w.style.zIndex) || 0));
            window.style.zIndex = maxZIndex + 1;
            
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', stopDrag);
        }
        
        function drag(e) {
            if (!isDragging) return;
            
            // Вычислить новую позицию окна
            let newLeft = e.clientX - dragOffsetX;
            let newTop = e.clientY - dragOffsetY;
            
            // Ограничить перемещение в пределах экрана
            const maxLeft = window.innerWidth - window.offsetWidth;
            const maxTop = window.innerHeight - window.offsetHeight;
            
            newLeft = Math.max(0, Math.min(newLeft, maxLeft));
            newTop = Math.max(0, Math.min(newTop, maxTop));
            
            // Установить новую позицию
            window.style.left = `${newLeft}px`;
            window.style.top = `${newTop}px`;
        }
        
        function stopDrag() {
            isDragging = false;
            document.removeEventListener('mousemove', drag);
            document.removeEventListener('mouseup', stopDrag);
        }
    });
}

function performSearch() {
    const searchInput = document.getElementById('start-search');
    const query = searchInput.value.trim().toLowerCase();
    
    if (query === '') return;
    
    // Поиск приложений
    const foundApps = APPS.filter(app => 
        app.name.toLowerCase().includes(query) || 
        app.description.toLowerCase().includes(query)
    );
    
    if (foundApps.length > 0) {
        const startMain = document.getElementById('start-main');
        startMain.innerHTML = `
            <div style="padding: 1rem;">
                <div class="section-title">Результаты поиска: "${query}"</div>
                <div class="recent-apps">
                    ${foundApps.slice(0, 10).map(app => `
                        <div class="recent-app" data-app="${app.id}">
                            <div class="recent-app-icon">
                                <i class="${app.icon}"></i>
                            </div>
                            <div class="recent-app-info">
                                <div class="recent-app-name">${app.name}</div>
                                <div class="recent-app-time">${app.category}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
                ${foundApps.length > 10 ? `
                    <div style="color: #94a3b8; margin-top: 1rem; text-align: center;">
                        И ещё ${foundApps.length - 10} результатов...
                    </div>
                ` : ''}
            </div>
        `;
        
        // Добавить обработчики событий
        startMain.querySelectorAll('[data-app]').forEach(element => {
            element.addEventListener('click', function() {
                const appId = this.dataset.app;
                openApp(appId);
                toggleStartMenu();
            });
        });
    } else {
        const startMain = document.getElementById('start-main');
        startMain.innerHTML = `
            <div style="padding: 1rem; text-align: center;">
                <div style="font-size: 4rem; color: #94a3b8; margin-bottom: 1rem;">
                    <i class="fas fa-search"></i>
                </div>
                <div style="font-size: 1.5rem; font-weight: 700; color: #f1f5f9; margin-bottom: 1rem;">
                    Ничего не найдено
                </div>
                <div style="color: #94a3b8;">
                    По запросу "${query}" ничего не найдено
                </div>
            </div>
        `;
    }
}

function showShutdownModal(defaultAction = 'shutdown') {
    const modal = document.getElementById('shutdown-modal');
    modal.style.display = 'flex';
    
    const closeBtn = document.getElementById('shutdown-close');
    const cancelBtn = document.getElementById('shutdown-cancel');
    
    const shutdownOption = document.getElementById('shutdown-option');
    const restartOption = document.getElementById('restart-option');
    const sleepOption = document.getElementById('sleep-option');
    const logoutOption = document.getElementById('logout-option');
    
    // Установить обработчики событий
    shutdownOption.onclick = () => performShutdown('shutdown');
    restartOption.onclick = () => performShutdown('restart');
    sleepOption.onclick = () => performShutdown('sleep');
    logoutOption.onclick = () => performShutdown('logout');
    
    closeBtn.onclick = cancelBtn.onclick = () => {
        modal.style.display = 'none';
    };
}

function performShutdown(action) {
    const modal = document.getElementById('shutdown-modal');
    modal.style.display = 'none';
    
    let message = '';
    
    switch(action) {
        case 'shutdown':
            message = 'Система выключается...';
            break;
        case 'restart':
            message = 'Система перезагружается...';
            break;
        case 'sleep':
            message = 'Система переходит в спящий режим...';
            break;
        case 'logout':
            message = 'Выход из системы...';
            break;
    }
    
    // Показать сообщение
    const overlay = document.createElement('div');
    overlay.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(15, 23, 42, 0.95);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 10000;
        color: white;
        font-size: 2rem;
        font-weight: 700;
    `;
    
    overlay.innerHTML = `
        <div style="margin-bottom: 2rem;">
            <i class="fas fa-${action === 'shutdown' ? 'power-off' : 
                               action === 'restart' ? 'redo' : 
                               action === 'sleep' ? 'moon' : 
                               'sign-out-alt'}" 
               style="font-size: 5rem; color: #3b82f6;"></i>
        </div>
        <div>${message}</div>
        <div style="margin-top: 2rem; font-size: 1rem; color: #94a3b8;">
            Через несколько секунд вы будете перенаправлены...
        </div>
    `;
    
    document.body.appendChild(overlay);
    
    // Имитация задержки и перезагрузки страницы
    setTimeout(() => {
        if (action === 'logout') {
            // Для выхода показываем экран блокировки
            document.body.removeChild(overlay);
            showLockScreen();
        } else {
            // Для других действий перезагружаем страницу
            location.reload();
        }
    }, 3000);
}

// ============================================
// ИНИЦИАЛИЗАЦИЯ ПРИЛОЖЕНИЙ
// ============================================

// Браузер
function initBrowser() {
    const urlInput = document.getElementById('url-input');
    const goButton = document.getElementById('go-button');
    const browserBack = document.getElementById('browser-back');
    const browserForward = document.getElementById('browser-forward');
    const browserRefresh = document.getElementById('browser-refresh');
    const browserHome = document.getElementById('browser-home');
    
    let history = [];
    let currentHistoryIndex = -1;
    
    function navigateToUrl(url) {
        if (!url.startsWith('http')) {
            url = 'https://' + url;
        }
        
        // Добавить в историю
        history.push(url);
        currentHistoryIndex = history.length - 1;
        
        // Обновить поле URL
        urlInput.value = url;
        
        // Обновить состояние кнопок навигации
        updateNavButtons();
        
        // Показать сообщение о загрузке
        document.getElementById('browser-status-text').textContent = 'Загрузка...';
        
        // В реальном браузере здесь была бы загрузка страницы
        // Для демо покажем сообщение
        setTimeout(() => {
            document.getElementById('browser-status-text').textContent = 'Загружено';
            
            // Показать уведомление
            addNotification('Браузер', `Страница ${url} загружена`, 'info');
        }, 1000);
    }
    
    function updateNavButtons() {
        browserBack.disabled = currentHistoryIndex <= 0;
        browserForward.disabled = currentHistoryIndex >= history.length - 1;
    }
    
    // Обработчики событий
    goButton.addEventListener('click', () => {
        const url = urlInput.value.trim();
        if (url) {
            navigateToUrl(url);
        }
    });
    
    urlInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            const url = urlInput.value.trim();
            if (url) {
                navigateToUrl(url);
            }
        }
    });
    
    browserBack.addEventListener('click', () => {
        if (currentHistoryIndex > 0) {
            currentHistoryIndex--;
            urlInput.value = history[currentHistoryIndex];
            updateNavButtons();
        }
    });
    
    browserForward.addEventListener('click', () => {
        if (currentHistoryIndex < history.length - 1) {
            currentHistoryIndex++;
            urlInput.value = history[currentHistoryIndex];
            updateNavButtons();
        }
    });
    
    browserRefresh.addEventListener('click', () => {
        if (urlInput.value) {
            navigateToUrl(urlInput.value);
        }
    });
    
    browserHome.addEventListener('click', () => {
        navigateToUrl('https://www.google.com');
    });
    
    // Быстрые ссылки
    window.navigateToUrl = navigateToUrl;
    
    // Инициализация
    navigateToUrl('https://www.google.com');
}

// Текстовый редактор
function initTextEditor() {
    const editorArea = document.getElementById('editor-area');
    const saveButton = document.getElementById('save-document');
    const newButton = document.getElementById('new-document');
    const boldButton = document.getElementById('bold-text');
    const italicButton = document.getElementById('italic-text');
    const underlineButton = document.getElementById('underline-text');
    
    // Сохранение документа
    saveButton.addEventListener('click', () => {
        const content = editorArea.innerHTML;
        const blob = new Blob([content], { type: 'text/html' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        
        a.href = url;
        a.download = 'документ.html';
        a.click();
        
        URL.revokeObjectURL(url);
        
        addNotification('Текстовый редактор', 'Документ сохранен успешно', 'success');
    });
    
    // Новый документ
    newButton.addEventListener('click', () => {
        editorArea.innerHTML = '<h1>Новый документ</h1><p>Начните вводить текст...</p>';
        addNotification('Текстовый редактор', 'Создан новый документ', 'info');
    });
    
    // Форматирование текста
    boldButton.addEventListener('click', () => {
        document.execCommand('bold');
        boldButton.classList.toggle('active');
    });
    
    italicButton.addEventListener('click', () => {
        document.execCommand('italic');
        italicButton.classList.toggle('active');
    });
    
    underlineButton.addEventListener('click', () => {
        document.execCommand('underline');
        underlineButton.classList.toggle('active');
    });
    
    // Отслеживание изменений для обновления статуса
    editorArea.addEventListener('input', () => {
        const text = editorArea.innerText || '';
        const lines = text.split('\n').length;
        const chars = text.length;
        
        document.getElementById('editor-info').textContent = `Строк: ${lines} | Символов: ${chars}`;
    });
}

// Медиаплеер
function initMediaPlayer() {
    const playButton = document.getElementById('player-play');
    const progressBar = document.getElementById('player-progress-bar');
    const progressFill = document.getElementById('player-progress-fill');
    const volumeSlider = document.getElementById('player-volume');
    
    let isPlaying = false;
    let currentTime = 0;
    let duration = 180; // 3 минуты для демо
    
    function formatTime(seconds) {
        const mins = Math.floor(seconds / 60);
        const secs = Math.floor(seconds % 60);
        return `${mins}:${secs.toString().padStart(2, '0')}`;
    }
    
    function updateProgress() {
        if (isPlaying) {
            currentTime += 0.5;
            if (currentTime > duration) {
                currentTime = 0;
                isPlaying = false;
                playButton.innerHTML = '<i class="fas fa-play"></i>';
            }
            
            const progressPercent = (currentTime / duration) * 100;
            progressFill.style.width = `${progressPercent}%`;
            document.getElementById('player-current-time').textContent = formatTime(currentTime);
        }
    }
    
    // Воспроизведение/пауза
    playButton.addEventListener('click', () => {
        isPlaying = !isPlaying;
        playButton.innerHTML = isPlaying ? 
            '<i class="fas fa-pause"></i>' : 
            '<i class="fas fa-play"></i>';
        
        if (isPlaying) {
            addNotification('Медиаплеер', 'Воспроизведение начато', 'info');
        }
    });
    
    // Прогресс
    progressBar.addEventListener('click', (e) => {
        const rect = progressBar.getBoundingClientRect();
        const percent = (e.clientX - rect.left) / rect.width;
        currentTime = percent * duration;
        
        const progressPercent = (currentTime / duration) * 100;
        progressFill.style.width = `${progressPercent}%`;
        document.getElementById('player-current-time').textContent = formatTime(currentTime);
    });
    
    // Громкость
    volumeSlider.addEventListener('input', (e) => {
        const volume = e.target.value;
        addNotification('Медиаплеер', `Громкость: ${volume}%`, 'info');
    });
    
    // Инициализация времени
    document.getElementById('player-duration').textContent = formatTime(duration);
    document.getElementById('player-current-time').textContent = formatTime(currentTime);
    
    // Обновление прогресса
    setInterval(updateProgress, 500);
}

// Калькулятор
function initCalculator() {
    const calculatorButtons = document.getElementById('calculator-buttons');
    const calcCurrent = document.getElementById('calc-current');
    const calcHistory = document.getElementById('calc-history');
    
    let currentInput = '0';
    let previousInput = '';
    let operation = null;
    let resetScreen = false;
    
    const buttons = [
        { text: 'C', class: 'clear', action: 'clear' },
        { text: '⌫', class: '', action: 'backspace' },
        { text: '%', class: 'operator', action: 'percent' },
        { text: '÷', class: 'operator', action: 'divide' },
        { text: '7', class: '', action: 'number' },
        { text: '8', class: '', action: 'number' },
        { text: '9', class: '', action: 'number' },
        { text: '×', class: 'operator', action: 'multiply' },
        { text: '4', class: '', action: 'number' },
        { text: '5', class: '', action: 'number' },
        { text: '6', class: '', action: 'number' },
        { text: '−', class: 'operator', action: 'subtract' },
        { text: '1', class: '', action: 'number' },
        { text: '2', class: '', action: 'number' },
        { text: '3', class: '', action: 'number' },
        { text: '+', class: 'operator', action: 'add' },
        { text: '0', class: 'zero', action: 'number' },
        { text: '.', class: '', action: 'decimal' },
        { text: '=', class: 'equals', action: 'equals' }
    ];
    
    // Создание кнопок
    buttons.forEach(button => {
        const btn = document.createElement('button');
        btn.className = `calc-button ${button.class}`;
        btn.textContent = button.text;
        btn.dataset.action = button.action;
        
        if (button.action === 'number' && button.text !== '0' && button.text !== '.') {
            btn.dataset.value = button.text;
        } else if (button.action === 'number' && button.text === '0') {
            btn.dataset.value = '0';
        }
        
        calculatorButtons.appendChild(btn);
    });
    
    // Обработчики событий
    calculatorButtons.addEventListener('click', (e) => {
        if (!e.target.matches('.calc-button')) return;
        
        const action = e.target.dataset.action;
        const value = e.target.dataset.value;
        
        switch(action) {
            case 'number':
                appendNumber(value);
                break;
            case 'decimal':
                appendDecimal();
                break;
            case 'clear':
                clearCalculator();
                break;
            case 'backspace':
                backspace();
                break;
            case 'add':
            case 'subtract':
            case 'multiply':
            case 'divide':
                setOperation(action);
                break;
            case 'percent':
                calculatePercent();
                break;
            case 'equals':
                calculate();
                break;
        }
        
        updateDisplay();
    });
    
    function appendNumber(number) {
        if (currentInput === '0' || resetScreen) {
            currentInput = number;
            resetScreen = false;
        } else {
            currentInput += number;
        }
    }
    
    function appendDecimal() {
        if (resetScreen) {
            currentInput = '0.';
            resetScreen = false;
            return;
        }
        
        if (!currentInput.includes('.')) {
            currentInput += '.';
        }
    }
    
    function clearCalculator() {
        currentInput = '0';
        previousInput = '';
        operation = null;
        calcHistory.textContent = '';
    }
    
    function backspace() {
        if (currentInput.length > 1) {
            currentInput = currentInput.slice(0, -1);
        } else {
            currentInput = '0';
        }
    }
    
    function setOperation(op) {
        if (operation !== null) {
            calculate();
        }
        
        previousInput = currentInput;
        operation = op;
        resetScreen = true;
        
        // Обновить историю
        const opSymbol = getOperationSymbol(op);
        calcHistory.textContent = `${previousInput} ${opSymbol}`;
    }
    
    function getOperationSymbol(op) {
        switch(op) {
            case 'add': return '+';
            case 'subtract': return '−';
            case 'multiply': return '×';
            case 'divide': return '÷';
            default: return '';
        }
    }
    
    function calculate() {
        if (operation === null || resetScreen) return;
        
        const prev = parseFloat(previousInput);
        const current = parseFloat(currentInput);
        
        if (isNaN(prev) || isNaN(current)) return;
        
        let result;
        switch(operation) {
            case 'add':
                result = prev + current;
                break;
            case 'subtract':
                result = prev - current;
                break;
            case 'multiply':
                result = prev * current;
                break;
            case 'divide':
                result = current !== 0 ? prev / current : 'Error';
                break;
        }
        
        // Обновить историю
        const opSymbol = getOperationSymbol(operation);
        calcHistory.textContent = `${previousInput} ${opSymbol} ${currentInput} =`;
        
        // Установить результат
        currentInput = typeof result === 'number' ? 
            (result % 1 === 0 ? result.toString() : result.toFixed(8).replace(/\.?0+$/, '')) : 
            result;
        
        operation = null;
        resetScreen = true;
    }
    
    function calculatePercent() {
        const current = parseFloat(currentInput);
        if (isNaN(current)) return;
        
        currentInput = (current / 100).toString();
        resetScreen = true;
    }
    
    function updateDisplay() {
        calcCurrent.textContent = currentInput;
    }
    
    // Инициализация
    updateDisplay();
}

// Графический редактор
function initPaint() {
    const canvas = document.getElementById('paint-canvas');
    const ctx = canvas.getContext('2d');
    const tools = document.querySelectorAll('.paint-tool');
    const colors = document.querySelectorAll('.paint-color');
    const brushSize = document.getElementById('brush-size');
    
    let isDrawing = false;
    let currentTool = 'brush';
    let currentColor = '#000000';
    let currentSize = 5;
    let lastX = 0;
    let lastY = 0;
    
    // Инициализация холста
    ctx.fillStyle = '#ffffff';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    
    // Выбор инструмента
    tools.forEach(tool => {
        tool.addEventListener('click', () => {
            tools.forEach(t => t.classList.remove('active'));
            tool.classList.add('active');
            currentTool = tool.dataset.tool;
        });
    });
    
    // Выбор цвета
    colors.forEach(color => {
        color.addEventListener('click', () => {
            colors.forEach(c => c.classList.remove('active'));
            color.classList.add('active');
            currentColor = color.style.backgroundColor;
        });
    });
    
    // Размер кисти
    brushSize.addEventListener('input', (e) => {
        currentSize = e.target.value;
    });
    
    // Рисование
    canvas.addEventListener('mousedown', startDrawing);
    canvas.addEventListener('mousemove', draw);
    canvas.addEventListener('mouseup', stopDrawing);
    canvas.addEventListener('mouseout', stopDrawing);
    
    function startDrawing(e) {
        isDrawing = true;
        [lastX, lastY] = getMousePos(e);
        
        if (currentTool === 'eraser') {
            ctx.globalCompositeOperation = 'destination-out';
        } else {
            ctx.globalCompositeOperation = 'source-over';
        }
    }
    
    function draw(e) {
        if (!isDrawing) return;
        
        ctx.strokeStyle = currentTool === 'eraser' ? 'rgba(0,0,0,1)' : currentColor;
        ctx.lineWidth = currentSize;
        ctx.lineCap = 'round';
        ctx.lineJoin = 'round';
        
        const [x, y] = getMousePos(e);
        
        ctx.beginPath();
        ctx.moveTo(lastX, lastY);
        ctx.lineTo(x, y);
        ctx.stroke();
        
        [lastX, lastY] = [x, y];
    }
    
    function stopDrawing() {
        isDrawing = false;
        ctx.beginPath(); // Завершаем путь
    }
    
    function getMousePos(e) {
        const rect = canvas.getBoundingClientRect();
        return [
            e.clientX - rect.left,
            e.clientY - rect.top
        ];
    }
    
    // Сохранение рисунка
    document.getElementById('paint-save').addEventListener('click', () => {
        const dataURL = canvas.toDataURL('image/png');
        const a = document.createElement('a');
        a.href = dataURL;
        a.download = 'рисунок.png';
        a.click();
        
        addNotification('Графический редактор', 'Рисунок сохранен успешно', 'success');
    });
    
    // Новый рисунок
    document.getElementById('paint-new').addEventListener('click', () => {
        ctx.fillStyle = '#ffffff';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        addNotification('Графический редактор', 'Создан новый рисунок', 'info');
    });
}

// Календарь
function initCalendar() {
    const calendarTitle = document.getElementById('calendar-title');
    const calendarDays = document.getElementById('calendar-days');
    const prevMonthButton = document.getElementById('calendar-prev-month');
    const nextMonthButton = document.getElementById('calendar-next-month');
    const prevYearButton = document.getElementById('calendar-prev-year');
    const nextYearButton = document.getElementById('calendar-next-year');
    
    let currentDate = new Date();
    
    function renderCalendar() {
        const year = currentDate.getFullYear();
        const month = currentDate.getMonth();
        
        // Обновить заголовок
        const monthNames = ['Январь', 'Февраль', 'Март', 'Апрель', 'Май', 'Июнь', 
                           'Июль', 'Август', 'Сентябрь', 'Октябрь', 'Ноябрь', 'Декабрь'];
        calendarTitle.textContent = `${monthNames[month]} ${year}`;
        
        // Очистить дни
        calendarDays.innerHTML = '';
        
        // Первый день месяца
        const firstDay = new Date(year, month, 1);
        // Последний день месяца
        const lastDay = new Date(year, month + 1, 0);
        // Первый день отображаемого календаря (может быть предыдущий месяц)
        const startDay = new Date(firstDay);
        startDay.setDate(startDay.getDate() - firstDay.getDay() + 1);
        
        // Текущая дата
        const today = new Date();
        const isToday = (date) => 
            date.getDate() === today.getDate() && 
            date.getMonth() === today.getMonth() && 
            date.getFullYear() === today.getFullYear();
        
        // Заполнить 42 дня (6 недель)
        for (let i = 0; i < 42; i++) {
            const day = new Date(startDay);
            day.setDate(startDay.getDate() + i);
            
            const dayElement = document.createElement('div');
            dayElement.className = 'calendar-day';
            
            if (day.getMonth() !== month) {
                dayElement.classList.add('other-month');
            }
            
            if (isToday(day)) {
                dayElement.classList.add('today');
            }
            
            dayElement.innerHTML = `
                <div class="day-number">${day.getDate()}</div>
                <div class="day-events"></div>
            `;
            
            // Добавить события (для демо)
            if (day.getDate() % 7 === 0 && day.getMonth() === month) {
                dayElement.querySelector('.day-events').innerHTML = `
                    <div class="day-event" style="background: #3b82f6;">Встреча</div>
                `;
            }
            
            if (day.getDate() === 15 && day.getMonth() === month) {
                dayElement.querySelector('.day-events').innerHTML = `
                    <div class="day-event" style="background: #10b981;">День рождения</div>
                `;
            }
            
            calendarDays.appendChild(dayElement);
        }
    }
    
    // Обработчики событий
    prevMonthButton.addEventListener('click', () => {
        currentDate.setMonth(currentDate.getMonth() - 1);
        renderCalendar();
    });
    
    nextMonthButton.addEventListener('click', () => {
        currentDate.setMonth(currentDate.getMonth() + 1);
        renderCalendar();
    });
    
    prevYearButton.addEventListener('click', () => {
        currentDate.setFullYear(currentDate.getFullYear() - 1);
        renderCalendar();
    });
    
    nextYearButton.addEventListener('click', () => {
        currentDate.setFullYear(currentDate.getFullYear() + 1);
        renderCalendar();
    });
    
    // Новое событие
    document.getElementById('calendar-new-event').addEventListener('click', () => {
        addNotification('Календарь', 'Создание нового события', 'info');
    });
    
    // Инициализация
    renderCalendar();
}

// Терминал
function initTerminal() {
    const terminalInput = document.getElementById('terminal-input');
    const terminalOutput = document.getElementById('terminal-output');
    const terminalUser = document.getElementById('terminal-user');
    const terminalPromptUser = document.getElementById('terminal-prompt-user');
    
    const commands = {
        help: () => `
            <div>Доступные команды:</div>
            <div>  help - показать эту справку</div>
            <div>  clear - очистить экран</div>
            <div>  date - показать текущую дату и время</div>
            <div>  echo [текст] - вывести текст</div>
            <div>  ls - список файлов</div>
            <div>  pwd - текущая директория</div>
            <div>  neofetch - информация о системе</div>
            <div>  theme [dark/light] - изменить тему</div>
            <div>  shutdown - выключить систему</div>
        `,
        
        clear: () => {
            terminalOutput.innerHTML = '';
            return '';
        },
        
        date: () => {
            const now = new Date();
            return now.toLocaleString('ru-RU');
        },
        
        echo: (args) => {
            return args.join(' ');
        },
        
        ls: () => {
            return `
                <div>Документы/</div>
                <div>Загрузки/</div>
                <div>Изображения/</div>
                <div>Музыка/</div>
                <div>Видео/</div>
                <div>readme.txt</div>
                <div>system.log</div>
            `;
        },
        
        pwd: () => {
            return '/home/user';
        },
        
        neofetch: () => {
            return `
                <div style="color: #3b82f6;">      ___           ___           ___     </div>
                <div style="color: #8b5cf6;">     /\\  \\         /\\  \\         /\\  \\    </div>
                <div style="color: #ec4899;">    /::\\  \\       /::\\  \\       /::\\  \\   </div>
                <div style="color: #3b82f6;">   /:/\\:\\  \\     /:/\\:\\  \\     /:/\\:\\  \\  </div>
                <div style="color: #8b5cf6;">  /:/  \\:\\  \\   /::\\~\\:\\  \\   /::\\~\\:\\  \\ </div>
                <div style="color: #ec4899;"> /:/__/ \\:\\__\\ /:/\\:\\ \\:\\__\\ /:/\\:\\ \\:\\__\\</div>
                <div style="color: #3b82f6;"> \\:\\  \\  \\/__/ \\/_|::\\/:/  / \\:\\~\\:\\ \\/__/</div>
                <div style="color: #8b5cf6;">  \\:\\  \\          |:|::/  /   \\:\\ \\:\\__\\  </div>
                <div style="color: #ec4899;">   \\:\\  \\         |:|\\/__/     \\:\\ \\/__/  </div>
                <div style="color: #3b82f6;">    \\:\\__\\        |:|  |        \\:\\__\\    </div>
                <div style="color: #8b5cf6;">     \\/__/         \\|__|         \\/__/    </div>
                <br>
                <div><span style="color: #10b981;">user</span>@<span style="color: #3b82f6;">afagos</span></div>
                <div>-------------------</div>
                <div><span style="color: #94a3b8;">ОС:</span> AfagOS 22H2</div>
                <div><span style="color: #94a3b8;">Ядро:</span> 5.15.0-afagos</div>
                <div><span style="color: #94a3b8;">Оболочка:</span> bash 5.1.16</div>
                <div><span style="color: #94a3b8;">Тема:</span> Dark</div>
                <div><span style="color: #94a3b8;">Разрешение:</span> ${window.innerWidth}x${window.innerHeight}</div>
            `;
        },
        
        theme: (args) => {
            if (args[0] === 'dark' || args[0] === 'light') {
                addNotification('Терминал', `Тема изменена на ${args[0]}`, 'info');
                return `Тема изменена на ${args[0]}`;
            }
            return 'Использование: theme [dark/light]';
        },
        
        shutdown: () => {
            showShutdownModal();
            return 'Запуск меню завершения работы...';
        }
    };
    
    function processCommand(input) {
        const parts = input.trim().split(' ');
        const command = parts[0].toLowerCase();
        const args = parts.slice(1);
        
        if (commands[command]) {
            return commands[command](args);
        } else {
            return `Команда не найдена: ${command}. Введите 'help' для списка команд.`;
        }
    }
    
    function addOutput(text) {
        const line = document.createElement('div');
        line.innerHTML = text;
        terminalOutput.appendChild(line);
        terminalOutput.scrollTop = terminalOutput.scrollHeight;
    }
    
    function addPrompt() {
        const promptLine = document.createElement('div');
        promptLine.className = 'terminal-line';
        promptLine.innerHTML = `
            <span style="color: #10b981;">user@afagos</span>
            <span style="color: #3b82f6;">~</span>
            <span style="color: white;">$</span>
            <span style="margin-left: 0.5rem;">${terminalInput.value}</span>
        `;
        terminalOutput.appendChild(promptLine);
    }
    
    terminalInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            const input = terminalInput.value.trim();
            
            if (input) {
                addPrompt();
                
                const output = processCommand(input);
                if (output) {
                    addOutput(output);
                }
            }
            
            terminalInput.value = '';
            terminalOutput.scrollTop = terminalOutput.scrollHeight;
        }
    });
    
    // Фокус на ввод при клике на терминал
    terminalOutput.addEventListener('click', () => {
        terminalInput.focus();
    });
    
    // Автофокус
    terminalInput.focus();
}

// Магазин приложений
function initAppStore() {
    const appStoreGrid = document.getElementById('app-store-grid');
    const storeSearch = document.getElementById('store-search');
    const storeSearchButton = document.getElementById('store-search-button');
    const categories = document.querySelectorAll('.store-category');
    
    let currentCategory = 'all';
    let currentSearch = '';
    
    function renderApps() {
        let filteredApps = APPS;
        
        // Фильтр по категории
        if (currentCategory !== 'all') {
            filteredApps = filteredApps.filter(app => app.category === currentCategory);
        }
        
        // Фильтр по поиску
        if (currentSearch) {
            const searchLower = currentSearch.toLowerCase();
            filteredApps = filteredApps.filter(app => 
                app.name.toLowerCase().includes(searchLower) || 
                app.description.toLowerCase().includes(searchLower)
            );
        }
        
        // Сортировка: установленные приложения первыми
        filteredApps.sort((a, b) => {
            if (a.installed && !b.installed) return -1;
            if (!a.installed && b.installed) return 1;
            return a.name.localeCompare(b.name);
        });
        
        appStoreGrid.innerHTML = filteredApps.map(app => `
            <div class="app-card">
                ${app.price > 0 && !app.installed ? `
                    <div class="app-badge">${app.price} ₽</div>
                ` : ''}
                
                <div class="app-icon">
                    <i class="${app.icon}"></i>
                </div>
                
                <div class="app-info">
                    <div class="app-name">${app.name}</div>
                    <div class="app-desc">${app.description}</div>
                    
                    <div class="app-meta">
                        <div class="app-rating">
                            <div class="stars">
                                ${app.rating ? `
                                    <i class="fas fa-star"></i>
                                    <span>${app.rating}</span>
                                ` : 'Без оценки'}
                            </div>
                        </div>
                        <div class="app-size">
                            <i class="fas fa-hdd"></i>
                            <span>${app.size || 'Не указано'}</span>
                        </div>
                    </div>
                    
                    <div class="app-price-container">
                        <div class="price-tag ${app.price === 0 ? 'free' : ''}">
                            ${app.price === 0 ? 'Бесплатно' : app.price + ' ₽'}
                        </div>
                        
                        <button class="install-button ${app.installed ? 'installed' : ''}" 
                                data-app="${app.id}"
                                ${app.installed ? 'disabled' : ''}>
                            <i class="fas fa-${app.installed ? 'check' : 'download'}"></i>
                            <span>${app.installed ? 'Установлено' : 'Установить'}</span>
                        </button>
                    </div>
                </div>
            </div>
        `).join('');
        
        // Добавить обработчики событий для кнопок установки
        appStoreGrid.querySelectorAll('.install-button').forEach(button => {
            button.addEventListener('click', function() {
                const appId = this.dataset.app;
                const app = APPS.find(a => a.id === appId);
                
                if (app && !app.installed) {
                    if (app.price === 0) {
                        // Бесплатное приложение - установить сразу
                        installApp(appId);
                    } else {
                        // Платное приложение - показать модальное окно
                        showPurchaseModal(app);
                    }
                }
            });
        });
    }
    
    function installApp(appId) {
        const appIndex = APPS.findIndex(a => a.id === appId);
        if (appIndex === -1) return;
        
        APPS[appIndex].installed = true;
        
        // Обновить интерфейс
        renderApps();
        
        // Добавить на рабочий стол, если нужно
        if (APPS[appIndex].desktopIcon) {
            createDesktopIcons();
        }
        
        addNotification('Магазин приложений', 
                       `Приложение "${APPS[appIndex].name}" успешно установлено`, 
                       'success');
    }
    
    function showPurchaseModal(app) {
        const modal = document.getElementById('purchase-modal');
        const modalText = document.getElementById('modal-text');
        const modalClose = document.getElementById('modal-close');
        const cancelButton = document.getElementById('cancel-purchase');
        const confirmButton = document.getElementById('confirm-purchase');
        
        modalText.textContent = `Вы уверены, что хотите купить "${app.name}" за ${app.price} ₽?`;
        modal.style.display = 'flex';
        
        // Обработчики событий
        const closeModal = () => {
            modal.style.display = 'none';
        };
        
        modalClose.onclick = closeModal;
        cancelButton.onclick = closeModal;
        
        confirmButton.onclick = () => {
            if (currentUser.balance >= app.price) {
                // Списать средства
                currentUser.balance -= app.price;
                document.getElementById('store-balance').textContent = `${currentUser.balance} ₽`;
                
                // Установить приложение
                installApp(app.id);
                
                addNotification('Покупка', 
                               `Приложение "${app.name}" успешно куплено и установлено!`, 
                               'success');
                
                closeModal();
            } else {
                addNotification('Ошибка покупки', 
                               'Недостаточно средств на балансе!', 
                               'error');
                closeModal();
            }
        };
    }
    
    // Поиск
    storeSearchButton.addEventListener('click', () => {
        currentSearch = storeSearch.value.trim();
        renderApps();
    });
    
    storeSearch.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            currentSearch = storeSearch.value.trim();
            renderApps();
        }
    });
    
    // Категории
    categories.forEach(category => {
        category.addEventListener('click', function() {
            categories.forEach(c => c.classList.remove('active'));
            this.classList.add('active');
            currentCategory = this.dataset.category;
            renderApps();
        });
    });
    
    // Инициализация
    renderApps();
}

// Инициализация всех приложений при открытии
function initAllApps() {
    initBrowser();
    initTextEditor();
    initMediaPlayer();
    initCalculator();
    initPaint();
    initCalendar();
    initTerminal();
    initAppStore();
}

// Запуск инициализации приложений после загрузки системы
setTimeout(initAllApps, 1000);

// ============================================
// ФИНАЛЬНАЯ ИНИЦИАЛИЗАЦИЯ
// ============================================

console.log('AfagOS успешно загружена!');
</script>

<!-- Добавляем стили для анимаций -->
<style>
    @keyframes fadeOut {
        from { opacity: 1; }
        to { opacity: 0; }
    }
</style>
</body>
</html>